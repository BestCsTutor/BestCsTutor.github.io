<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Python代写：ECE326OptimalStrategyCalculator, 留学生CS|辅导|代写">
    <meta name="description" content="代写游戏  Easy Blackjack 的博弈规则。![EasyBlackjack](https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Blackjack_game_1.J">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Python代写：ECE326OptimalStrategyCalculator | 留学生CS|辅导|代写</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.1.1"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">留学生CS|辅导|代写</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>辅导案例集合</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/comment" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>用户评价</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>联系我</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">留学生CS|辅导|代写</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			辅导案例集合
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/comment" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			用户评价
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			联系我
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/23.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Python代写：ECE326OptimalStrategyCalculator</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python%E4%BB%A3%E5%86%99/">
                                <span class="chip bg-color">Python代写</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-10-18
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>代写游戏 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Blackjack" title="Blackjack"> Easy Blackjack </a><br>的博弈规则。<br>![Easy<br>Blackjack](<a target="_blank" rel="noopener" href="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Blackjack_game_1.JPG/250px-">https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Blackjack_game_1.JPG/250px-</a><br>Blackjack_game_1.JPG)</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>This assignment is the kind you can expect if you work in an actuary, e.g.<br>calculating expected return and assessing risk. Since Easy Blackjack is a game<br>of chance, short term result may fluctuate and not be representative of the<br>expected value of playing the game long term. There are two main methods for<br>measuring expected value of a game: 1) by repeating a random experiment many<br>times until the arithmetic mean of the values in the experiments converges to<br>the expected value, and 2) by calculating it mathematically.<br>If you are unfamiliar with the term probability and expected value, you should<br>review these two concepts before continuing. We suggest two YouTube videos to<br>help you get started quickly: Probability and Expected Value.<br>In assignment 1, you developed a program that can estimate expected value of<br>the game (i.e. player advantage) through repeated trials. In this assignment,<br>you will come up with the optimal strategy table and calculate the player<br>advantage associated with it. Fortunately, you can double check and&#x2F;or debug<br>your calculation by using your assignment 1 solution and compare the result<br>with the theoretical player advantage that you have calculated.<br>Unlike in a real casino, we will be using an infinite shoe, meaning that the<br>probability of receiving any card on the next draw remains constant and<br>independent (e.g. probability of receiving an ace is always 1&#x2F;13). This<br>property simplifies our calculation. In the real world, removing a card would<br>reduce the probability that a card of the same value can be drawn. For<br>example, receiving an ace would mean that there is one fewer ace left in the<br>shoe.</p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>Add the starter code for this assignment, available in optimal.tar, to your<br>repository. You may add additional files to help you organize your code. When<br>we mark your code, we will run python3 main.py …<br>    cd ~&#x2F;ece326<br>    tar -xf &#x2F;cad2&#x2F;ece326f&#x2F;src&#x2F;optimal.tar<br>    git status # should say that “asst2&#x2F;“ directory is untracked<br>    git add asst2 git commit -m “Initial code for Assignment 2”<br>    git tag Asst2-start<br>    git push<br>    git push –tags cd asst2<br>Here is a rundown of the code provided to you:</p>
<ul>
<li>main.py: contains the main function and functions to print the result that you return. You should not change this file, but do try to understand what it’s doing. Note that it imports easybj.py as a module. Our tester will also import your version of easybj.py as a module to mark your solution. </li>
<li>table.py: you will change this file to implement a two-dimensional, spreadsheet-like table, as part of the first milestone. </li>
<li>easybj.py: The meat of the assignment. It contains some basic definitions to help you start the assignment. You will have to add substantial code to finish the assignment, but as mentioned, you can do it in steps. You may also add more files and have this file import them, if it helps you organize your work better.</li>
</ul>
<h2 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h2><p>If you have not done so already, you should go back to assignment 1 and make<br>sure you still have a solid understanding of the rules of Easy Blackjack. In<br>this assignment, the same rules of the game still applies.<br>At a high level, we will use divide and conquer to break down the problem into<br>smaller subproblems. For every possible action in Easy Blackjack, there is an<br>associated expected value (EV). For example, the EV for surrendering is always<br>-0.5, because you lose half of your bet when choosing the action. The optimal<br>action, in each situation, is thus the action that yields the highest EV. For<br>example, you have hard 19 versus dealer hard 20, the expected value of each<br>action is as follows:</p>
<table>
<thead>
<tr>
<th>Action</th>
<th>EV</th>
</tr>
</thead>
<tbody><tr>
<td>Hit</td>
<td>-0.768</td>
</tr>
<tr>
<td>Double</td>
<td>-1.538</td>
</tr>
<tr>
<td>Stand</td>
<td>-1.000</td>
</tr>
<tr>
<td>Surrender</td>
<td>-0.500</td>
</tr>
<tr>
<td>Don’t worry about where these numbers come from for now. In the table above,</td>
<td></td>
</tr>
<tr>
<td>we can see that surrender is the best option because you lose the least amount</td>
<td></td>
</tr>
<tr>
<td>of money. Stand, for example, always results in losing the entire bet since</td>
<td></td>
</tr>
<tr>
<td>the dealer will not hit hard 20 and your hard 19 loses to hard 20.</td>
<td></td>
</tr>
<tr>
<td>Now, it may become clear what the subproblems are: finding the EV of each</td>
<td></td>
</tr>
<tr>
<td>action for every combination of player’s hand and dealer’s hand. For the</td>
<td></td>
</tr>
<tr>
<td>purpose of this assignment, we call each specific combination of player&#x2F;dealer</td>
<td></td>
</tr>
<tr>
<td>hands an encounter. Once you calculated all of them, then you can determine</td>
<td></td>
</tr>
<tr>
<td>the optimal action for every step of the game. We call the result of this set</td>
<td></td>
</tr>
<tr>
<td>of calculations an “EV Table”.</td>
<td></td>
</tr>
<tr>
<td>Fundamentally, there are two types of actions: terminal versus non-terminal.</td>
<td></td>
</tr>
<tr>
<td>Terminal actions are ones where you may no longer take any more actions, i.e.,</td>
<td></td>
</tr>
<tr>
<td>surrender, stand, double, or split aces. Non-terminal actions in Blackjack are</td>
<td></td>
</tr>
<tr>
<td>hit and split non-aces hands.</td>
<td></td>
</tr>
<tr>
<td>To calculate the EV tables for terminal actions, you simply need to take the</td>
<td></td>
</tr>
<tr>
<td>action, let the dealer take his&#x2F;her actions (if necessary, e.g. for surrender,</td>
<td></td>
</tr>
<tr>
<td>dealer wins automatically), then you compare hands. For non-terminal actions,</td>
<td></td>
</tr>
<tr>
<td>you still need to first take the action (e.g., hit). However, since the action</td>
<td></td>
</tr>
<tr>
<td>is non-terminal, then what happens after the initial action if there are</td>
<td></td>
</tr>
<tr>
<td>further actions (i.e., you did not bust nor did you reach 21, at which you</td>
<td></td>
</tr>
<tr>
<td>stand automatically)?</td>
<td></td>
</tr>
<tr>
<td>The answer is that you should take the optimal action, meaning you are picking</td>
<td></td>
</tr>
<tr>
<td>the best available options after the initial action based on the expected</td>
<td></td>
</tr>
<tr>
<td>value of each action. This is logically sound because our objective is to</td>
<td></td>
</tr>
<tr>
<td>maximize expected value, and thus every action we take should always return</td>
<td></td>
</tr>
<tr>
<td>the highest expected value out of all available actions. If you do not know</td>
<td></td>
</tr>
<tr>
<td>which action is optimal, then you will need to solve the subproblems</td>
<td></td>
</tr>
<tr>
<td>(calculating the EVs of all actions) before you can solve this problem</td>
<td></td>
</tr>
<tr>
<td>(choosing the optimal action).</td>
<td></td>
</tr>
</tbody></table>
<h3 id="Stand-EV"><a href="#Stand-EV" class="headerlink" title="Stand EV"></a>Stand EV</h3><p>The easiest EV table (besides surrender) to calculate is for standing. Since<br>the player won’t take any more cards, the points for his&#x2F;her hand is fixed.<br>However, the dealer may take more cards. Therefore, the EV of standing is the<br>weighted average of all outcomes after the dealer is done. For example, if you<br>stand on hard 18 against the dealer’s hard 16, the following outcomes are<br>possible:</p>
<table>
<thead>
<tr>
<th>Dealer</th>
<th>Outcome</th>
<th>Probability</th>
<th>EV</th>
</tr>
</thead>
<tbody><tr>
<td>17</td>
<td>+1</td>
<td>1&#x2F;13</td>
<td>1&#x2F;13</td>
</tr>
<tr>
<td>18</td>
<td>0</td>
<td>1&#x2F;13</td>
<td>0</td>
</tr>
<tr>
<td>19,20,21</td>
<td>-1</td>
<td>3&#x2F;13</td>
<td>-3&#x2F;13</td>
</tr>
<tr>
<td>bust</td>
<td>+1</td>
<td>8&#x2F;13</td>
<td>8&#x2F;13</td>
</tr>
<tr>
<td>Here, observe that the dealer can only hit one more card before standing</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>(since his&#x2F;her points will go up by at least 1, i.e. receiving an ace). The EV</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>of each outcome is the outcome i pi, where the sum of pi is equal to 1.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Finally, the EV standing on hard 18 against dealer’s hard 16 is the sum of the</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EV of all possible outcomes, which is 6&#x2F;13 or 0.462.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Of course, if the dealer has a low starting hand, then it is possible that the</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>dealer will hit multiple times. In this case, you will need recursion and</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>dynamic programming to help you solve the problem more elegantly. Since you</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>should already be familiar with recursion, we will explain dynamic programming</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>and how it works.</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Dynamic-Programming"><a href="#Dynamic-Programming" class="headerlink" title="Dynamic Programming"></a>Dynamic Programming</h3><p>Dynamic programming is an optimization technique where the result of a<br>function is cached (saved) so that the cached result is returned on future<br>invocation. This technique will greatly speed up the calculation by avoiding<br>redundant and possibly expensive recomputation. There are some restrictions as<br>to when dynamic programming can be used (i.e. the function must be “pure” –<br>see lecture note for more thorough explanation). For our purposes, you only<br>need to know that the function may not depend on any mutable non-local<br>variables (constant ones are fine).<br>Continuing from previous example, suppose this time the dealer has hard 15<br>(the player’s hand is not relevant), and we want to calculate the probability<br>distribution F(hard 15) for all possible points that the dealer ends with. We<br>would arrive at the following table:</p>
<table>
<thead>
<tr>
<th>Next Card</th>
<th>Dealer</th>
<th>Probability</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>16</td>
<td>1&#x2F;13</td>
</tr>
<tr>
<td>2-6</td>
<td>17-21</td>
<td>5&#x2F;13</td>
</tr>
<tr>
<td>7-K</td>
<td>bust</td>
<td>7&#x2F;13</td>
</tr>
<tr>
<td>There is a 1&#x2F;13 chance that the dealer gets an ace, where he&#x2F;she would have to</td>
<td></td>
<td></td>
</tr>
<tr>
<td>keep hitting. However, from previous example, we already calculated F(hard</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16)! Therefore, if we have saved the result for F(hard 16), we can use it</td>
<td></td>
<td></td>
</tr>
<tr>
<td>immediately and merge the two tables together, where F(hard 15) &#x3D; 1&#x2F;13*F(hard</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16) + F(hard 15</td>
<td>not ace) for the following final table.</td>
<td></td>
</tr>
<tr>
<td>Dealer</td>
<td>Probability</td>
<td></td>
</tr>
<tr>
<td>—</td>
<td>—</td>
<td></td>
</tr>
<tr>
<td>17</td>
<td>1&#x2F;13 + 1&#x2F;13 * 1&#x2F;13</td>
<td></td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td></td>
</tr>
<tr>
<td>21</td>
<td>1&#x2F;13 + 1&#x2F;13 * 1&#x2F;13</td>
<td></td>
</tr>
<tr>
<td>bust</td>
<td>7&#x2F;13 + 1&#x2F;13 * 8&#x2F;13</td>
<td></td>
</tr>
<tr>
<td>A general suggestion for this assignment is make use of the assert function to</td>
<td></td>
<td></td>
</tr>
<tr>
<td>make sure your assumptions hold. Your program will crash if the assertion</td>
<td></td>
<td></td>
</tr>
<tr>
<td>fails, which allows you to debug the problem immediately. For example, the sum</td>
<td></td>
<td></td>
</tr>
<tr>
<td>of the probabilities in all dealer probability tables should be equal to 1.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Assuming you are using a Python dictionary to store the table, you can check</td>
<td></td>
<td></td>
</tr>
<tr>
<td>this using the following snippet of code:</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<pre><code>#  
# use math.isclose() for Python 3.5 or later  
# use this for earlier versions of Python  
#  
def isclose(a, b=1., rel_tol=1e-09, abs_tol=0.0):  
  return abs(a-b) [= max(rel\_tol * max(abs(a), abs(b)), abs\_tol)  
def make_dealer_table(table):  
  # ...  
  # make sure the probabilities add up to 1  
  assert(isclose(sum(table.values()), 1.0))  
</code></pre>
<p>—|—<br>Lastly, we would save the result for F(hard 15) so that future calculation<br>that uses it does not require recomputation. There are many opportunities to<br>take advantage of dynamic programming in this assignment, and you will see as<br>you continue reading.<br>Question: How many dealer probability tables do you need to complete the stand<br>EV table?</p>
<h3 id="Hit-EV"><a href="#Hit-EV" class="headerlink" title="Hit EV"></a>Hit EV</h3><p>Correctly calculating the Hit EV table requires that you first complete the<br>Stand EV table. The reason is that the EV for hitting depends on the optimal<br>action between hitting and standing, i.e. it is a non-terminal action. Let’s<br>suppose you hit on hard 17 against dealer’s hard 18. Your possible outcomes<br>are as follows:</p>
<table>
<thead>
<tr>
<th>Player</th>
<th>Probability</th>
<th>Outcome</th>
<th>EV</th>
</tr>
</thead>
<tbody><tr>
<td>18-20</td>
<td>3&#x2F;13</td>
<td>?</td>
<td>?</td>
</tr>
<tr>
<td>21</td>
<td>1&#x2F;13</td>
<td>+1</td>
<td>1&#x2F;13</td>
</tr>
<tr>
<td>bust</td>
<td>9&#x2F;13</td>
<td>-1</td>
<td>-9&#x2F;13</td>
</tr>
<tr>
<td>You may be asking, why is the outcome of achieving 18 to 20 points unknown? It</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>is because the algorithm is unsure whether it is better to hit or stand after</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>the initial hit, for example, on hard 20 against dealer’s hard 18. On the</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>surface, it seems obvious that you would stand in this case, but there are</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>many other situations where it may be a close call. Therefore, your algorithm</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>must cast aside all doubt and verify that it is indeed better to stand than to</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>hit, or vice versa.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>There are always two base cases in the recursion where you would stop hitting:</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>arriving at 21 points or busting. In the above example, hitting on hard 20</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>results in an EV of 1&#x2F;13 - 12&#x2F;13 (only an ace will save you) &#x3D; -11&#x2F;13. On the</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>other hand, standing on hard 20 guarantees a win because the dealer does not</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>hit hard 18, so it’s EV is +1.000. In this case, it is now clear that you</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>should pick stand and not hit.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Both memoisation and dynamic programming can be effective for calculating hit</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EV. Using memoisation, you would make the initial hit, and for all subsequent</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>encounters, recursively calculate the hit EVs if they are not in the hit EV</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>table, or just use the value straight from the table and compare with the</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>stand EV, which you have already calculated. For dynamic programming, you</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>would iterate through all hands, starting from the base case (hard 20), and</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ending at hard 4.</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Double-EV"><a href="#Double-EV" class="headerlink" title="Double EV"></a>Double EV</h3><p>Since doubling down is a terminal action, it is very similar to stand, except<br>you would hit before you stand, making it possible that you bust in the<br>process. Otherwise, the algorithm is similar, except the expected value is<br>doubled since the player is risking twice the amount of money to take this<br>action.</p>
<h3 id="Split-EV"><a href="#Split-EV" class="headerlink" title="Split EV"></a>Split EV</h3><p>Because split is a non-terminal action, except in the case of splitting aces,<br>again, you will need to make the optimal decision after the initial split<br>occurs. However, because of the hand limit of up to 4, using recursion and<br>memoisation may not be intuitive. Therefore, we suggest that you use dynamic<br>programming, where you start from the smallest subproblem and work our way up.<br>Assuming you have already completed all other tables, then split EV’s base<br>subproblem is deciding the optimal action after you cannot split anymore,<br>either because the hand cannot be split or the hand limit has been reached. At<br>this point, the valid actions remaining are hit, double, or stand. Therefore,<br>using the existing tables, you can calculate a base table for splitting. You<br>should use STAND_CODE for the ylabels of this table since one of the actions<br>includes standing and none of the actions involves splitting (you can’t split<br>anymore!).<br>One complication of splitting is dealing with the many ways where the hand<br>limit can be reached. Fortunately, it is actually not an issue you need to<br>worry about, because unlike in assignment 1, we are exploring all possible<br>outcomes of having N hands. As such, how we arrived at N hands has no impact<br>on the expected value having N hands.<br>As an example, suppose you have 99 and 99. Assuming the hand limit is only 3,<br>you may only split one more time. Now, does it matter which of the 99 you<br>split? No. Because the expected value of splitting the first 99 and the second<br>99 is exactly the same. With this insight, then the problem of splitting up to<br>4 times is a lot more tractable. While you are going through the set of hands<br>that can result from a split, always split a hand as long as the hand limit<br>has not been reached. So in the case where the initial XX is split into XX1<br>and XX2, you should assume that both of them will be split, meaning that no<br>subsequent split after the two resplits are possible.<br>The only situation that you have to worry about is when you split into two<br>hands, both of which can be split again, but there’s only room for one more.<br>For example, 880 splits into 8T and 881, and 881 is split into 882 and 883. In<br>this case, one of the 88 cannot be split again and must be treated as base<br>case.<br>Since there are multiple levels after the initial split to consider, you will<br>actually need a total of 4 tables for the split action. The base case table<br>(discussed earlier), split1, split2, and split3, where the subscript of each<br>split table is the number of hands remaining that can be split. The split3<br>table represents the initial split from one hand, and is the one that the<br>tester expects. split3 will include the EV for splitting AA, whereas split2<br>and split1 should not, since you are not allowed to resplit AA.</p>
<h3 id="Player-Advantage"><a href="#Player-Advantage" class="headerlink" title="Player Advantage"></a>Player Advantage</h3><p>Once you have calculated the EV of all possible actions for all combinations<br>of hands, you would be able to generate a compact table of the optimal actions<br>and their associated EV. To calculate the player advantage, you need the<br>weighted average of the optimal EV of all possible starting hand combinations<br>(sum of pi pj EVij, where pi is the probability of the player’s starting hand<br>i, and pj is the probability of the dealer’s starting hand j).</p>
<h2 id="Solution-Requirements"><a href="#Solution-Requirements" class="headerlink" title="Solution Requirements"></a>Solution Requirements</h2><p>To help you with this assignment, we have broken it up into multiple<br>milestones. The program will take zero or more arguments, with the argument<br>being the name of the table that you wish to print. For example:<br>    python3 main.py stand optimal<br>This will print both the stand EV table and the optimal EV table. Partial<br>marks will be given for completing some of the milestones. The list of all<br>accepted arguments are as follows:</p>
<ul>
<li>initial: print the initial probability table (see subsection for more detail) </li>
<li>dealer: print the dealer probability table (see subsection for more detail) </li>
<li>stand: print the stand EV table </li>
<li>hit: print the hit EV table </li>
<li>double: print the double EV table </li>
<li>split: print the split EV table </li>
<li>optimal: print the optimal EV table </li>
<li>strategy: print the strategy table </li>
<li>advantage: print the theoretical player advantage<br>If no arguments are given, the program will print everything. Note that all of<br>the argument parsing has been done for you. You just need to produce the<br>correct results for each of the milestone.</li>
</ul>
<h3 id="Table-class"><a href="#Table-class" class="headerlink" title="Table class"></a>Table class</h3><p>The first milestone of the assignment is to complete the implementation for<br>table.py. In the file is an incomplete implementation of an ordered,<br>homogeneous, two-dimensional table, similar to an spreadsheet. The table takes<br>a 2-tuple (a tuple with two elements) and either raises an error or returns<br>the value in the corresponding cell. A cell is to a spreadsheet (2D) what an<br>element is to a list (1D). The 2-tuple is in the form (y, x), where y is the<br>row name and x is the column name. For example, table[“a”,”m”] will return the<br>cell value for row a column m. Let’s now describe the interface of the Table<br>class.<br>    Table.<strong>init</strong>(self, celltype, xlabels, ylabels, unit&#x3D;””)<br>—|—  </p>
<ul>
<li>celltype: the data type of each cell, e.g., str, int, or float. It is an error to set a cell with a value that is not specified cell type. </li>
<li>xlabels: a sequence of all x-axis labels (i.e. column names) accepted by the table. </li>
<li>ylabels: a sequence of all y-axis labels (i.e. row names) accepted by the table. </li>
<li>unit: this argument is used to print the table. You do not need to do anything about it.<br>For example, the table Table(str, “abcd”, range(1,5)) will create the<br>following table:<br>  a  b  c  d<br>1 – – – –<br>2 – – – –<br>3 – – – –<br>4 – – – –<br>Notice that the cell values are “empty”, that is because their values by<br>default is set to None unless you set it. For example, table[3,’b’] &#x3D; “HI”<br>will update the table:<br>  a  b  c  d<br>1 – – – –<br>2 – – – –<br>3 – HI – –<br>4 – – – –<br>You must create a suitable data structure to store data for the table, and<br>implement all operations supportd by the index operator: get, set, and delete.</li>
<li><strong>getitem</strong>(self, idx): return the cell value given a valid 2-tuple, or None if the cell is empty. </li>
<li><strong>setitem</strong>(self, idx, val): set the cell value to val given a valid 2-tuple. Note that type checking on val is already done for you. </li>
<li><strong>delitem</strong>(self, idx): set the cell value to None given a valid 2-tuple.</li>
</ul>
<h3 id="Hand-class"><a href="#Hand-class" class="headerlink" title="Hand class"></a>Hand class</h3><p>We provide you the skeleton code for the hand class in easybj.py, which<br>currently stores the cards that are in the hand and specifies whether the hand<br>belongs to player or dealer. With this, it is enough for you to complete an<br>important method, Hand.code, which will be used throughout this assignment to<br>fill the table.<br>For the purpose of this assignment, the code of a hand represents its strength<br>and potential. It comes in three forms: hard hands, soft hands, and split<br>hands. For hard hands, the code is the score of the hand. We define the score<br>of a hand to be equal to the point value of the hand, except that the score is<br>zero if the hand is busted. This simplifies comparing hand strength using<br>integer comparison. As an example, the code ‘15’ represents hard 15. For soft<br>hands, it will start with an ace ‘A’. For example, ‘A6’ denotes soft 17, and<br>‘A9’ denotes soft 20. Note that the actual hand can have more cards than what<br>the code depicts. For example, A45 is also soft 20. If the point value of the<br>hand is 21, then if it is also blackjack, the hand code is ‘BJ’, otherwise it<br>is ‘21’, regardless of whether it is hard or soft. Lastly, split hands are<br>always two of the same number or letter, for example, ‘AA’, ‘55’, or ‘TT’.<br>Remember that ‘AA’ is both a soft hand and a split hand.<br>Hand code can vary based on whether split is possible and who owns the hand.<br>In the first case, if split is not possible, then the hand code is the<br>correponding hard or soft hand code. For example, ‘22’ becomes ‘4’, and ‘99’<br>becomes ‘18’. However, ‘AA’ remains ‘AA’ since it has dual meanings. In the<br>second case, if the hand belongs to a dealer, then there are two adjustments.</p>
<ol>
<li>the dealer never splits, so he&#x2F;she does not use any split codes. 2) the<br>dealer treats soft 18 or above as hard 18, so ‘A7’ or higher becomes ‘18’ and<br>higher, respectively.<br>Your next milestone is to complete Hand.code according to the above<br>specificaiton. Once this is done, it will automatically finish the<br>implementation for calculating the initial probability table. This table shows<br>the probability of receiving a specific hand against a specific dealer hand.<br>You can see it via the following command:<br> python3 main.py initial<br>At this point, you may have already noticed how these codes are used by the<br>table. The x-axis is a list of all possible starting hands for the dealer, and<br>the y-axis is a list of all possible hands for the player for a particular<br>situation. At the top of easybj.py are a list of codes. For example,<br>INITIAL_CODE is a list of player’s hand code for the initial deal. We will<br>explain what other lists are used for in the next few subsections.</li>
</ol>
<h3 id="Dealer-Table"><a href="#Dealer-Table" class="headerlink" title="Dealer Table"></a>Dealer Table</h3><p>The dealer probabilities table is a collection of subtables that contain the<br>exact probability of each dealer outcome for a particular dealer starting<br>hand. For example, if the dealer starts with hard 17, then there would only be<br>one entry in the subtable: 17: 1.000, since the dealer does not hit hard 17 or<br>higher. You will need this table to be able to complete the stand EV table (it<br>is also possible to complete both tables together using memoisation technique<br>instead of dynamic programming).<br>The format of the dealer table is different from other EV tables: it is a<br>dictionary of dictionaries. At the top level, the key is the dealer’s starting<br>hand code and the value is the associated subtable (also a dictionary). At the<br>bottom level, the dictionary stores each outcome in score (using zero for<br>busted hands) and the value of each outcome is its probability. Use the<br>methodology as described in the Approach section to complete this table. Below<br>is out of the example output for dealer hard 16:<br>    Dealer 16<br>     0: 0.615385 17: 0.076923 18: 0.076923 19: 0.076923 20: 0.076923 21: 0.076923</p>
<h3 id="EV-Tables"><a href="#EV-Tables" class="headerlink" title="EV Tables"></a>EV Tables</h3><p>You will need to produce an EV table for each of the actions: stand, hit,<br>double, and split. Note that surrender is not necessary since all entries will<br>be filled with -0.5. The tables have already been initialized for you in the<br>Calculator class constructor. Your task is to populate the cells of each table<br>with the correct expected value for each player&#x2F;dealer encounter. Notice that<br>these tables ignore the situation if either the player or dealer (or both) has<br>blackjack. This is done mainly to compact the table since the game ends<br>immediately and no actions need to be taken. You should study how the initial<br>probability table was populated and use a similar method to work on the other<br>tables.<br>There are two irregularities worth mentioning in these tables that may help<br>you gain a better understanding of the process. First, the stand table has an<br>extra entry, 21, for the player. While the player stands on 21 automatically,<br>the game continues and the player is not guaranteed to win in this situation<br>(e.g., if the dealer also gets 21). Second, the split table only contains<br>entries for split hands. This may be more obvious since all other hand types<br>cannot be split. You should return the initial split table, as described in<br>the Split EV section, and not the resplit tables.<br>Lastly, for the optimal table, as described in the Approach section, you will<br>need to compare all available actions (including surrender) for each<br>player&#x2F;dealer encounter and choose the one with the highest expected value.</p>
<h3 id="Strategy-Table"><a href="#Strategy-Table" class="headerlink" title="Strategy Table"></a>Strategy Table</h3><p>This part can be done as part of calculating the optimal EV table. Instead of<br>entering numbers into the table, you enter the exact action that should be<br>taken for each encounter. For double and surrender, an alternative action (hit<br>or stand only) needs to be specified in case the primary is unavailable. Split<br>does not need an alternative action since the reader of the strategy table<br>should instead look up the hand as a hard total. The format of the strategy<br>table is the same as described in assignment 1.</p>
<h3 id="Player-Advantage-1"><a href="#Player-Advantage-1" class="headerlink" title="Player Advantage"></a>Player Advantage</h3><p>Calculate the theoretical player advantage using the optimal EV table and the<br>initial probability table, as described in the Approach section.</p>
<h2 id="Code-Submission"><a href="#Code-Submission" class="headerlink" title="Code Submission"></a>Code Submission</h2><p>To submit your code with the current commit, use the Asst2-end tag. Remember<br>to push the new tag to the remote repository.<br>    git tag Asst2-end &#x2F;&#x2F; Creates tag for current submission for Assignment 2<br>    git push –tags</p>
<h2 id="Glossary-of-Terms"><a href="#Glossary-of-Terms" class="headerlink" title="Glossary of Terms"></a>Glossary of Terms</h2><p>Here, you can find the definition of commonly seen terms that are used in the<br>assignment. More will be added as people ask questions about the assignment.</p>
<ul>
<li>point: refers to the point value of the hand. For example, 88 is 16 and 999 is 27 (which is busted) </li>
<li>score: refers to the relative strength of the hand when compared with another. Score and point are the same for a hand that has not busted. If a hand is busted, it’s score is zero. </li>
<li>code: a two character name used to signify the strength and the potential of the hand. </li>
<li>encounter: a player having a particular hand versus the dealer’s particular hand.</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">SafePoker</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://saferman.github.io/2019/10/18/Python%E4%BB%A3%E5%86%99%EF%BC%9AECE326OptimalStrategyCalculator/">http://saferman.github.io/2019/10/18/Python%E4%BB%A3%E5%86%99%EF%BC%9AECE326OptimalStrategyCalculator/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">SafePoker</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python%E4%BB%A3%E5%86%99/">
                                    <span class="chip bg-color">Python代写</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s12 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/newqrcode.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2019/10/19/Java%E4%BB%A3%E5%86%99%EF%BC%9ACS142RockPaperScissors/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="Java代写：CS142RockPaperScissors">
                        
                        <span class="card-title">Java代写：CS142RockPaperScissors</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2019-10-19
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Java代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/10/17/Python%E4%BB%A3%E5%86%99%EF%BC%9AFNCE30012FoundationsofFintech/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="Python代写：FNCE30012FoundationsofFintech">
                        
                        <span class="card-title">Python代写：FNCE30012FoundationsofFintech</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2019-10-17
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Python代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2024</span>
            
            <a href="/contact" target="_blank">SafePoker</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:hhh@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
