<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Java代写：CIS455WebandApplicationServer, cs辅导|cs代写|计算机辅导|AI辅导|网络安全">
    <meta name="description" content="使用Java代写一个servlets的Web服务。  
BackgroundWe are all familiar with how one accesses a Web server via a browser. The bigquest">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Java代写：CIS455WebandApplicationServer | cs辅导|cs代写|计算机辅导|AI辅导|网络安全</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.1.1"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">cs辅导|cs代写|计算机辅导|AI辅导|网络安全</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>作业思路分享</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/comment" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>用户评价</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>联系我</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">cs辅导|cs代写|计算机辅导|AI辅导|网络安全</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			作业思路分享
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/comment" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			用户评价
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			联系我
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/17.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Java代写：CIS455WebandApplicationServer</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Java%E4%BB%A3%E5%86%99/">
                                <span class="chip bg-color">Java代写</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-10-20
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>使用Java代写一个servlets的Web服务。  </p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>We are all familiar with how one accesses a Web server via a browser. The big<br>question is what is going on under the covers of the Web server: how does it<br>serve data?, what is necessary in order to provide the notion of sessions?,<br>how is it extended?, and so on.<br>This assignment focuses on developing an application server, i.e., a Web<br>(HTTP) server that runs Java servlets, in two stages. In the first stage, you<br>will implement a simple HTTP server for static content (i.e., files like<br>images, style sheets, and HTML pages). In the second stage, you will expand<br>this work to emulate a full-fledged application server that runs servlets.<br>Java servlets are a popular method for writing dynamic Web applications. They<br>provide a cleaner and much more powerful interface to the Web server and Web<br>browser than previous methods, such as CGI scripts.<br>A Java servlet is simply a Java class that extends the class HttpServlet. It<br>typically overrides the doGet and doPost methods from that class to generate a<br>web page in response to a request from a Web browser. An XML file, web.xml,<br>lets the servlet developer specify a mapping from URLs to class names; this is<br>how the server knows which class to invoke in response to an HTTP request.<br>Further details about servlets, including links to tutorials and an API<br>reference, as well as sample servlets and a corresponding web.xml file, are<br>available on the course web site. We have also given you code to parse<br>web.xml.</p>
<h2 id="Developing-and-running-your-code"><a href="#Developing-and-running-your-code" class="headerlink" title="Developing and running your code"></a>Developing and running your code</h2><p>We strongly recommend that you do the following before you start writing code:</p>
<ol>
<li>Carefully read the entire assignment (both milestones) from front to back and make a list of the features you need to implement. </li>
<li>Think about how the key features will work. For instance, before you start with MS2, go through the steps the server will need to perform to handle a request. If you still have questions, have a look at some of the extra material on the assignments page, or ask one of us during office hours. </li>
<li>Spend at least some time thinking about the design of your solution. What classes will you need? How many threads will there be? What will their interfaces look like? Which data structures need synchronization? And so on. </li>
<li>Regularly check your changes into the Git repository. This will give you many useful features, including a recent backup and the ability to roll back any changes that have mysteriously broken your code.<br>We recommend that you continue using the VM image we have provided for HW0.<br>This image should already contain all the tools you will need for HW1. If you<br>have already checked out the code from your Git repository, all you need to do<br>to get the HW1 framework code is open a terminal and run “cd ~&#x2F;workspace”<br>followed by “git pull”. After this, there should be a new “HW1” folder in the<br>workspace directory; you can import this folder as a project into Eclipse<br>using the same approach as in HW0.<br>Of course, you are free to use any other Java IDE you like, or no IDE at all,<br>and you do not have to use any of the tools we provide. However, to ensure<br>efficient grading, your submission must meet the requirements specified in 3.5<br>and 4.7 below - in particular, it must build and run correctly in the original<br>VM image and have a Maven build script (pom.xml). The VM image, and Maven,<br>will be the ‘gold standard’ for grading.<br>We strongly recommend that you regularly check the discussions on Piazza for<br>clarifications and solutions to common problems.</li>
</ol>
<h3 id="Testing-your-server"><a href="#Testing-your-server" class="headerlink" title="Testing your server"></a>Testing your server</h3><p>To test your server, you have several options:</p>
<ul>
<li>You can use the Developer Tools in Chrome to inspect the HTTP headers. Open the menu, choose “More Tools”, and click on “Developer tools”. This should pop up a new tab; click on “Network” to open a list of all the HTTP requests processed by Chrome, click on a request for extra details, and then click on “Headers” to see the headers. </li>
<li>If you want to check whether you are using the correct headers, you may find the site web-sniffer.net useful. </li>
<li>You can use the telnet command to directly interact with the server. Just run telnet localhost 80, type in the request, and hit Enter twice; you should see the server’s response. (If your server is running on a different port, replace ‘80’ with the port number.) </li>
<li>You may also want to consider using the curl command-line utility to do some automated testing of your server. curl makes it easy to test HTTP&#x2F;1.1 compliance by sending HTTP requests that are purposefully invalid - e.g., sending an HTTP&#x2F;1.1 request without a Host header. ‘man curl’ lists a great many flags. </li>
<li>To stress-test your server, you can use Apachebench (the ab command, which is already pre- installed in the VM). Apachebench can be configured to make many requests concurrently, which will help you find concurrency problems, deadlocks, etc.<br>We suggest that you use multiple options for testing; if you only use Firefox,<br>for instance, there is a risk that you hard-code assumptions about Firefox, so<br>your solution won’t work with Chrome, curl, or ab. You may also want to<br>compare your server’s behavior with that of a known-good server, e.g., the CIS<br>web server. Please do test your solution carefully!</li>
</ul>
<h2 id="Milestone-1-Multithreaded-HTTP-1-1-Server"><a href="#Milestone-1-Multithreaded-HTTP-1-1-Server" class="headerlink" title="Milestone 1: Multithreaded HTTP&#x2F;1.1 Server"></a>Milestone 1: Multithreaded HTTP&#x2F;1.1 Server</h2><p>For the first milestone, your task is relatively simple. You will develop a<br>Web server that can be invoked from the command line, taking the following<br>parameters, in this order:</p>
<ol>
<li>Port to listen for connections on. Port 80 is the default HTTP port, but it is often blocked by firewalls, so your server should be able to run on any other port (e.g., 8080) </li>
<li>Root directory of the static web pages. For example, if this is set to the directory &#x2F;var&#x2F;www, a request for &#x2F;mydir&#x2F;index.html will return the file &#x2F;var&#x2F;www&#x2F;mydir&#x2F;index.html. (do not hard-code any part of the path in your code - your server needs to work on a different machine, which may have completely different directories!)<br>Note that the second milestone will add a third argument (see below). If your<br>server is invoked without any command-line arguments, it must output your full<br>name and SEAS login name.<br>Your program will accept incoming GET and HEAD requests from a Web browser<br>(such as the Firefox browser in the VM image), and it will make use of a<br>thread pool (as discussed in class) to invoke a worker thread to process each<br>request. The worker thread will parse the HTTP request, determine which file<br>was requested (relative to the root directory specified above) and return the<br>file. If a directory was requested, the request should return a listing of the<br>files in the directory. Your server should return the correct MIME types for<br>some basic file formats, based on the extension (.jpg, .gif, .png, .txt,<br>.html); keep in mind that image files must be sent in binary form – not with<br>println or equivalent – otherwise the browser will not be able to read them.<br>If a GET or HEAD request is made that is not a valid UNIX path specification,<br>if no file is found, or if the file is not accessible, you should return the<br>appropriate HTTP error. See the HTTP Made Really Easy paper for more details.<br>MAJOR SECURITY CONCERN: You should make sure that users are not allowed to<br>request absolute paths or paths outside the root directory. We will validate,<br>e.g., that we can’t get hold of &#x2F;etc&#x2F;passwd!</li>
</ol>
<h3 id="HTTP-protocol-version-and-features"><a href="#HTTP-protocol-version-and-features" class="headerlink" title="HTTP protocol version and features"></a>HTTP protocol version and features</h3><p>Your application server must be HTTP 1.1 compliant, and it must support all<br>the features described in HTTP Made Really Easy. This means that it must be<br>able to support HTTP 1.0 clients as well as 1.1 clients. Persistent<br>connections are suggested but not required for HTTP 1.1 servers. If you do not<br>wish to support persistent connections, be sure to include “Connection: close”<br>in the header of the response. Chunked encoding (sometimes called chunking) is<br>also not required. Support for persistent connections and chunking is extra<br>credit, described near the end of this assignment.<br>HTTP Made Really Easy is not a complete specification, so you will<br>occasionally need to look at RFC 2616 (the ‘real’ HTTP specification; <a target="_blank" rel="noopener" href="http://www.ietf.org/rfc/rfc2616.txt"><br>http://www.ietf.org/rfc/rfc2616.txt </a> )<br>for protocol details. If you have a protocol-related question, please make an<br>effort to find the answer in the spec before you post the question to Piazza!</p>
<h3 id="Special-URLs"><a href="#Special-URLs" class="headerlink" title="Special URLs"></a>Special URLs</h3><p>Your application server should implement two special URLs. If someone issues a<br>GET &#x2F;shutdown, your server should shut down immediately; however, any threads<br>that are still busy handling requests must be aborted properly (do not just<br>call System.exit!). If someone issues a GET &#x2F;control, your server should<br>return a ‘control panel’ web page, which must contain at least a) your full<br>name and SEAS login, b) a list of all the threads in the thread pool, c) the<br>status of each thread (‘waiting’ or the URL it is currently handling), and d)<br>a button that shuts down the server, i.e., is linked to the special &#x2F;shutdown<br>URL. It must be possible to open the special URLs in a normal web browser.</p>
<h3 id="Implementation-techniques"><a href="#Implementation-techniques" class="headerlink" title="Implementation techniques"></a>Implementation techniques</h3><p>For efficiency, your application server must be implemented using a thread<br>pool that you implement, as discussed in class. Specifically, there should be<br>one thread that listens for incoming TCP requests and enqueues them, and some<br>number of threads that process the requests from the queue and return the<br>responses. We will examine your code to make sure it is free of race<br>conditions and the potential for deadlock, so code carefully!<br>We expect you to write your own thread pool code, not use one from the Java<br>system library or an external library. This includes the queue, which you<br>should implement by yourself, using condition variables to block and wake up<br>threads. You may not use the BlockingQueue that comes with Java, or any<br>similar classes.</p>
<h3 id="Tips-for-testing-and-debugging"><a href="#Tips-for-testing-and-debugging" class="headerlink" title="Tips for testing and debugging"></a>Tips for testing and debugging</h3><p>When you test your solution with Firefox or Chrome, you will sometimes see<br>more than one request, even if you open only one web page. This is because the<br>browser sometimes checks whether there is an icon (favicon.ico) for the web<br>page; just handle this additional request as you would handle any other<br>request. Another common problem when requesting binary files, such as images,<br>is that the file is not displayed properly or is shown as ‘broken’. Typically,<br>the reason is that your server is sending a few extra bytes or is missing a<br>few bytes, e.g., due to an off-by-one error; it might also be converting some<br>character sequences, e.g., a \n to a \r\n. Try saving the file to disk in the<br>browser, and then compare its length and contents to the original file.<br>When stress-testing your solution with Apachebench, you may sometimes see some<br>failed connections (“Connection reset by peer”). To fix this, try turning off<br>any console logging during the stress test, since this will slow down your<br>server and prevent it from keeping up. You can also increase the second<br>argument to ServerSocket, which limits the number of connections that can be<br>“waiting” at any given time. Finally, you may want to try running the<br>following two commands in a terminal:<br>    sudo sh -c ‘echo 1024 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;core&#x2F;somaxconn’<br>    sudo sh -c ‘echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_syncookies’<br>The first one increases a relevant kernel parameter, and the second disables a<br>defense against denial-of-service attacks that is sometimes triggered by the<br>benchmark.</p>
<h3 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h3><p>Your solution must meet the following requirements (please read carefully!):</p>
<ol>
<li>Your main class must be called HttpServer, and it must be located in a package. </li>
<li>Your submission must contain a) the entire source code, as well as any supplementary files needed to build your solution, b) a Maven build script called pom.xml (a template is included with the code in your Git repository), and c) a README file. The README file must contain 1) your full name and SEAS login name, 2) a description of features implemented, 3) any extra credit claimed, and 4) any special instructions for building or running. </li>
<li>When your submission is unpacked in the original VM image and the Maven build script is run (mvn clean install), your solution must compile correctly. Please test this before submitting! </li>
<li>Your server must accept the two command-line arguments specified above, and it must output your full name and SEAS login name when invoked without command-line arguments. </li>
<li>Your solution must be submitted using the online submission system (see the link on the course web page) before the relevant deadline on the first page of this handout. The only exception is if you have obtainend an extension online (using the “Extend” link in the submission system). </li>
<li>You must check your submission into your Git repository after you submit it. Run “git status” in the workspace directory to check for modifications, use “git add” to add any new files or directories you created, and then run “git commit” followed by “git push”. Be sure to check whether these commands actually succeed. If necessary, consult <a target="_blank" rel="noopener" href="https://git-scm.com/documentation"> https://git-scm.com/documentation </a> . </li>
<li>Your code must contain a reasonable amount of useful documentation.<br>You may not use any third-party code other than the standard Java libraries<br>(exceptions noted in the assignment) and any code we provide.</li>
</ol>
<h2 id="Milestone-2-Servlet-Engine"><a href="#Milestone-2-Servlet-Engine" class="headerlink" title="Milestone 2: Servlet Engine"></a>Milestone 2: Servlet Engine</h2><p>The second milestone will build upon the Web server from Milestone 1, with<br>support for POST and for invoking servlet code. To ease implementation, your<br>application server will need to support only one web application at a time.<br>Therefore, you can simply add the class files for the web application to the<br>classpath when you invoke you application server from the command line, and<br>pass the location of the web.xml file as an argument. Furthermore, you need<br>not implement all of the methods in the various servlet classes; details as to<br>what is required may be found below.</p>
<h3 id="The-Servlet"><a href="#The-Servlet" class="headerlink" title="The Servlet"></a>The Servlet</h3><p>A servlet is typically stored in a special “war file” (extension .war) which<br>is essentially a jar file with a special layout. The configuration information<br>for a servlet is specified in a file called web.xml, which is typically in the<br>WEB-INF directory. The servlet’s actual classes are typically in WEB-<br>INF&#x2F;classes. The web.xml file contains information about the servlet class to<br>be invoked, its name for the app server, and various parameters to be passed<br>to the servlet.<br>The servlet and servlet-class elements are used to establish an internal name<br>for your servlet, and which class it binds to. The servlet-mapping associates<br>the servlet with a particular sub-URL ( <a target="_blank" rel="noopener" href="http://my-server/MyServlet"> http://my-server/MyServlet
</a> or similar). There are two kinds of URL patterns<br>to handle:</p>
<ol>
<li>Exact pattern (must start with a &#x2F;). This is the most common way of specifying a servlet. </li>
<li>Path mapping (starts with a &#x2F; and ends with a *, meaning it should match on the prefix up to the <em>). This is used in a certain Web service scheme called “REST” (which we discuss later in the term). As a special case, &#x2F;foo&#x2F;</em> should match &#x2F;foo (without the trailing forward slash).<br>There are two ways that parameters can be specified from “outside” the<br>servlet, e.g., to describe setup information such as usernames and passwords,<br>servlet environment info, etc. These are through init- param elements, which<br>appear within servlet elements and establish name-value pairs for the servlet<br>configuration, and the context-param elements, which establish name-value<br>pairs for the servlet context. We will discuss how these are accessed<br>programmatically in a moment.</li>
</ol>
<h3 id="Basic-Servlet-Operation"><a href="#Basic-Servlet-Operation" class="headerlink" title="Basic Servlet Operation"></a>Basic Servlet Operation</h3><p>All servlets implement the javax.servlet.http.HttpServlet interface, which<br>extends the Servlet interface. You will need to build the “wrapping” that<br>invokes the HttpServlet instance, calling the appropriate functions and<br>passing in the appropriate objects.<br>Servlet initialization, config, and context. When the servlet is first<br>activated (by starting it in the app server), this calls the init() method,<br>which is passed a ServletConfig object. This may request certain resources,<br>open persistent connections, etc. The ServletConfig details information about<br>the servlet setup, including its ServletContext. Both of these can be used to<br>get parameters from web.xml.<br>ServletConfig represents the information a servlet knows about “itself”.<br>Calling getInitParameter() on the ServletConfig returns the servlet init-param<br>parameters. The method getParameterNames() returns the full set of these<br>parameters. Finally, one can get the servlet’s name (from web.xml) through<br>this interface. ServletContext represents what the servlet sees about its<br>related Web application. Calling getInitParameter() on the ServletContext<br>returns the servlet context-param parameters. The method getParameterNames()<br>returns the full set of these parameters. Through the context, the servlet can<br>also access resources that are within the .war file, and determine the real<br>path for a given “virtual” path (i.e., a path relative to the servlet).<br>Perhaps more important, the ServletContext provides a way of passing objects<br>(“attributes” that are name-object pairs) among different parts of a Web<br>application. You may ignore the context’s logging capabilities.<br>Service request and response. When a request is made of the servlet by an HTTP<br>client, the app server calls the service() method with a<br>javax.servlet.ServletRequest parameter containing request info, and a<br>javax.servlet.ServletResponse parameter for response info. For an HTTP servlet<br>(the only kind we are implementing), service() typically calls a handler for<br>the type of HTTP request. The only ones we care about are doGet() for GET<br>requests, and doPost() for POST requests. (There are other kinds of calls, but<br>these are seldom supported in practice.) Both doGet() and doPost() are given<br>parameter objects implementing javax.servlet.HttpServletRequest and<br>javax.servlet.HttpServletResponse (which are subclassed from the original<br>ServletRequest and ServletResponse). HttpServletRequest, naturally, contains<br>information about the HTTP request, including headers, parameters, etc. You<br>can get header information from getHeader() and its related methods, and get<br>form parameters through getParameter(). HttpSession is used to store state<br>across servlet invocations. The getAttribute() and related methods support<br>storing name-value pairs. The session should time-out after the designated<br>amount of time (specified as a default or in setMaxInactiveInterval()).<br>HttpServletResponse contains an object that is used to return information to<br>the Web browser or HTTP client. The getWriter() or getOutputStream() methods<br>provide a means of directly sending data that goes onto the socket to the<br>client. Also important are addHeader(), which adds a name-value pair for the<br>response header, and its sibling methods for adding header information. Note<br>that there are a variety of important fields you can set this way, e.g.,<br>server, content-length, refresh rate, content-type, etc. Note that you should<br>ensure that an HTTP response code (e.g., “200 OK”) is sent to the client<br>before any output from the writer or output stream are returned. If the<br>servlet throws an exception before sending output, you should return an error<br>code such as “500 Internal Server Error”. You should return a “302 Redirect”<br>if the servlet calls HttpServletResponse’s sendRedirect() method.<br>Servlet shutdown. When the servlet is deactivated, this calls the servlet’s<br>destroy() method, which should release resources allocated by init().</p>
<h3 id="Invocation-of-the-application-server"><a href="#Invocation-of-the-application-server" class="headerlink" title="Invocation of the application server"></a>Invocation of the application server</h3><p>You should add a third command-line argument: the location of the web.xml file<br>for your web application. In your submission, this file should be located in<br>the conf subdirectory. You may accept additional optional arguments after the<br>initial three (such as number of worker threads, for example), but the<br>application should run with reasonable defaults if they are omitted.</p>
<h3 id="Special-URLs-1"><a href="#Special-URLs-1" class="headerlink" title="Special URLs"></a>Special URLs</h3><p>You should now augment the special URLs you implemented for MS1. The &#x2F;shutdown<br>URL should properly shut down all the servlets, by invoking their destroy<br>methods, and the &#x2F;control URL should now provide a way to view the error log.<br>It may provide other (e.g., extra-credit) features as you see fit.</p>
<h3 id="Implementation-techniques-1"><a href="#Implementation-techniques-1" class="headerlink" title="Implementation techniques"></a>Implementation techniques</h3><p>Dynamic loading of classes in Java which you will need to do since a servlet<br>can have any arbitrary name, as specified in web.xml can be a bit tricky.<br>Start by calling the method Class.forName, with the string name of the class<br>as an argument, to get a Class object representing the class you want to<br>instantiate (i.e. a specific servlet). Since your servlets do not define a<br>constructor, you can then call the method newInstance() on that Class object,<br>and typecast it to an instance of your servlet. Now you can call methods on<br>this instance.</p>
<h3 id="Required-application-server-features"><a href="#Required-application-server-features" class="headerlink" title="Required application server features"></a>Required application server features</h3><p>Your application server must provide functional implementations of all of the<br>non-deprecated methods in the interfaces HttpServletRequest,<br>HttpServletResponse, ServletConfig, ServletContext, and HttpSession of the<br>Servlet interface version 2.5 ( [ <a target="_blank" rel="noopener" href="http://download.oracle.com/otn-">http://download.oracle.com/otn-</a><br>pub&#x2F;jcp&#x2F;servlet-2.5-mr5-oth-JSpec&#x2F;servlet-2.5-mr5-spec.pdf&#x2F;<br>](<a target="_blank" rel="noopener" href="http://download.oracle.com/otn-pub/jcp/servlet-2.5-mr5-oth-">http://download.oracle.com/otn-pub/jcp/servlet-2.5-mr5-oth-</a><br>JSpec&#x2F;servlet-2.5-mr5-spec.pdf&#x2F;) ), with the following exceptions:</p>
<ul>
<li>ServletContext.log </li>
<li>ServletContext.getMimeType (return null) </li>
<li>ServletContext.getNamedDispatcher </li>
<li>ServletContext.getResource </li>
<li>ServletContext.getResourceAsStream </li>
<li>ServletContext.getResourcePaths </li>
<li>HttpServletRequest.getPathTranslated </li>
<li>HttpServletRequest.getUserPrincipal </li>
<li>HttpServletRequest.isUserInRole </li>
<li>HttpServletRequest.getRequestDispatcher - HttpServletRequest.getInputStream </li>
<li>HttpServletResponse.getOutputStream </li>
<li>HttpServletRequest.getLocales </li>
<li>ServletContext.getNamedDispatcher </li>
<li>ServletContext.getRequestDispatcher </li>
<li>ServletContext.getContextPath<br>You may return null for the output of all of the above methods, as well as all<br>deprecated methods. We will also make the following simplifications and<br>clarifications of the spec:</li>
<li>HttpServletRequest.getAuthType should always return BASIC AUTH (“BASIC”) </li>
<li>HttpServletRequest.getPathInfo should always return the remainder of the URL request after the portion matched by the url-pattern in web-xml. It starts with a “&#x2F;“. </li>
<li>HttpServletRequest.getQueryString should return the HTTP GET query string, i.e., the portion after the “?” when a GET form is posted. </li>
<li>HttpServletRequest.getCharacterEncoding should return “ISO-8859-1” by default, and the results of setCharacterEncoding if it was previously called. </li>
<li>HttpServletRequest.getScheme should return “http”. </li>
<li>HttpServletResponse.getCharacterEncoding should return “ISO-8859-1”. </li>
<li>HttpServletResponse.getContentType should return “text&#x2F;html” by default, and the results of setContentType if it was previously called. </li>
<li>HttpServletResponse.getLocale should return null by default, or the results of setLocale if it was previously called. </li>
<li>HttpServletRequest.isRequestedSessionIdFromUrl should always return false.<br>This means that your application server will need to support cookies, sessions<br>(using cookies you don’t need to provide a fall-back like path encoding if the<br>client doesn’t support cookies), servlet contexts, initialization parameters<br>(from the web.xml file) - in other words, all of the infrastructure needed to<br>write real servlets. It also means that you won’t need to do HTTP-based<br>authentication, or implement the ServletInputStream and ServletOutputStream<br>classes.<br>We suggest you start by determining what you need to implement:</li>
</ul>
<ol>
<li>Print the JavaDocs for HttpServletRequest, HttpServletResponse, Servlet- Config, ServletContext, and HttpSession, from the URL given previously. </li>
<li>Create a skeleton class for each of the above, with methods that temporarily return null for each call. Be sure that your HttpServletRequest class inherits from the provided javax.servlet.HttpServletRequest (in the .jar file), and so forth. </li>
<li>Print the sample web.xml from the extra&#x2F;Servlets&#x2F;web&#x2F;WEB-INF directory. There is very useful information in the comments, which will help you determine where certain methods get their data.<br>You can find a simple parser for the web.xml file from the TestHarness code<br>(see 5.1 and the code in extra&#x2F;TestHarness). For the ServletConfig and<br>ServletContext, note the following:</li>
</ol>
<ul>
<li>There is a single ServletContext per “Web application,” and a single ServletConfig per “servlet page.” (For the base version of Milestone 2, you will only need to run one application at a time.) Assuming a single application will likely simplify some of what you need to implement in ServletContext (e.g., getServletNames). </li>
<li>Most of the important ServletConfig infoservlet name, init parameter names, and init parameter list come directly from web.xml. </li>
<li>The ServletContext init parameters come from the context-param elements in web.xml. </li>
<li>The ServletContext attributes are essentially a hash map from name to value, and can be used, e.g., to communicate between multiple instances of the same servlet. By default, these can only be created programmatically by servlets themselves, unlike the initialization parameters, which are set in web.xml. The ServletContext name is set to the display name specified in web.xml. </li>
<li>The real path of a file can be getting the canonical path of the path relative to the Web root. It is straightforward to return a stream to such a resource, as well. The URL to a relative path can similarly be generated relative to the Servlet’s URL.</li>
</ul>
<h3 id="Requirements-1"><a href="#Requirements-1" class="headerlink" title="Requirements"></a>Requirements</h3><p>Your solution must meet the same requirements as MS1 (see 3.4 above), with two<br>exceptions. First, your solution must now support three command-line arguments<br>(the third is the location of web.xml), and second, you need to submit at<br>least one test case for each of the major classes you implemented.</p>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><p>The framework code in your Git repository includes (in the extra directory)<br>the source code for a simple application server that accepts requests from the<br>command line, calls a servlet, and prints results back out. It will give you a<br>starting point, though many of the methods are just stubs, which you will need<br>to implement. We have also provided a suite of simple test servlets and an<br>associated web.xml file and directory of static content; it should put your<br>application server through its paces. We will, however, test your application<br>server with additional servlets.</p>
<h3 id="TestHarness-A-primitive-app-server"><a href="#TestHarness-A-primitive-app-server" class="headerlink" title="TestHarness: A primitive app server"></a>TestHarness: A primitive app server</h3><p>TestHarness gives you a simple command-line interface to your servlets. It<br>reads your web.xml file to find out about servlets. Thus, in order to test a<br>servlet you need to add the appropriate entry in web.xml first (as you would<br>do in order to deploy it). You can then specify a series of requests to<br>servlets on the command line, which all get executed within a servlet session.<br>Suppose you have a servlet ‘demo’ in your web.xml file. To run:</p>
<ol>
<li>Put the TestHarness classes and the servlet code in the same Eclipse project. </li>
<li>Make sure the file servlet-api.jar has been added to the project as an ‘external jar file.’ </li>
<li>Create a new run profile (Run ! Run…), choose TestHarness as the main class, and give the command line arguments path&#x2F;to&#x2F;web.xml GET demo to have the TestHarness program run the demo servlet’s doGet method.<br>The servlet output is printed to the screen as unprocessed HTML. You can set<br>the profile’s root directory if it makes writing the path to the web.xml<br>easier; it defaults to the root of the Eclipse project. More interestingly, if<br>you had a servlet called login, you could also run it with the arguments:<br>path&#x2F;to&#x2F;web.xml POST login?login&#x3D;aaa&amp;passwd&#x3D;bbb<br>This will call the doPost method with the parameters login and passwd passed<br>as if the servlet was invoked through Tomcat.<br>Finally, TestHarness also supports sequences of servlets while maintaining<br>session information that is passed between them. Suppose you had a servlet<br>called listFeeds, which a used can run only after logging in. You can simulate<br>this with the harness by doing:<br>path&#x2F;to&#x2F;web.xml POST login?login&#x3D;aaa&amp;passwd&#x3D;bbb GET listFeeds<br>In general, since your servlets would normally expect to be passed the session<br>object when executed, in order to test them with this harness you should<br>simulate the steps that would be followed to get from the login page to that<br>servlet. If for example after login you go to formA and enter some values and<br>click a button to submit formA to servletA, and then you enter some more<br>values in formB and click a button and go to servletB, to test servletB<br>(assuming you use post everywhere) you would do.</li>
</ol>
<h2 id="Extra-credit"><a href="#Extra-credit" class="headerlink" title="Extra credit"></a>Extra credit</h2><h3 id="HTTPS-support"><a href="#HTTPS-support" class="headerlink" title="HTTPS support"></a>HTTPS support</h3><p>For this extra-credit task, you need to extend your server with support for<br>HTTPS. Add a boolean constant called useHTTPs in your code. When this constant<br>is set to true, your solution should accept HTTPS connections on the port that<br>was specified on the command line; otherwise it should work exactly as<br>described in the main part of the assignment. You may want to have a look at<br>the javax.net.ssl package, and particularly at the SSLServerSocket class.<br>Please document in your README file where the constant is, as well as any<br>other setup steps that are needed to run your server in HTTPS mode.</p>
<h3 id="Event-driven-server"><a href="#Event-driven-server" class="headerlink" title="Event-driven server"></a>Event-driven server</h3><p>This extra-credit item is only available for MS1. To claim it, you must submit<br>two working versions of your web server: One with a thread pool, and a second,<br>event-driven one. The event handlers must be non-blocking, i.e., all I&#x2F;O must<br>be asynchronous (Java NIO). We recommend that you first implement the basic<br>server and then refactor it to be event-driven.</p>
<h3 id="HTTP-2-support"><a href="#HTTP-2-support" class="headerlink" title="HTTP&#x2F;2 support"></a>HTTP&#x2F;2 support</h3><p>For this extra-credit task, you need to add support for the more recent<br>protocol version, HTTP&#x2F;2, which can be found in RFC7540. Add a boolean<br>constant called useHTTP2 in your code; when this constant is set to true, your<br>solution should accept HTTP&#x2F;2 connections; otherwise it should work exactly as<br>described in the main part of the assignment. Please document in your README<br>file where the constant is. To complete this task by itself, you can implement<br>the protocol version that runs over cleartext TCP; alternatively, you can<br>combine this task with Task 6.1 (“HTTPS support”) and implement the TLS-based<br>version for +30% extra credit total. (In that case HTTPS support for HTTP&#x2F;1.1<br>won’t count separately.) This task is not for the faint of heart, so you<br>should only attempt it if MS1 was relatively easy for you.</p>
<h3 id="Persistent-HTTP-connections-and-chunked-encoding"><a href="#Persistent-HTTP-connections-and-chunked-encoding" class="headerlink" title="Persistent HTTP connections and chunked encoding"></a>Persistent HTTP connections and chunked encoding</h3><p>We do not require persistence or chunking in your basic HTTP 1.1 server.<br>However, each of these will count for part of up to 10% extra credit. To get<br>full credit for chunking support, your server needs to be able to both send<br>and receive chunked messages.</p>
<h3 id="Performance-testing"><a href="#Performance-testing" class="headerlink" title="Performance testing"></a>Performance testing</h3><p>The supplied servlet BusyServlet performs a computationally intestive task<br>that should take a number of seconds to perform on a modern computer.<br>Experimentally determine the effect of changing the thread pool size on<br>performance of the application server when many requests for BusyServlet come<br>in at the same time. Comment on any trends you see, and try to explain them.<br>Suggest the ideal thread pool size and describe how you chose it. Include<br>performance measures like tables, graphs, etc.</p>
<h3 id="Multiple-applications-and-dynamic-loading"><a href="#Multiple-applications-and-dynamic-loading" class="headerlink" title="Multiple applications and dynamic loading"></a>Multiple applications and dynamic loading</h3><p>The project described above loads one web application and installs it at the<br>root context. Extend it to dynamically load and unload other applications at<br>different contexts. Add options to the main menu of the server to list<br>installed applications, install new applications, and remove any installed<br>applications. You’ll need to take special care to ensure that static variables<br>do not get shared between applications (i.e. the same class in two different<br>applications can have different values for the same static variable). Each<br>application should have its own servlet context as well. (Since each<br>application may have its own classpath, be sure to add the capability to<br>dynamically modify the classpath, too.)</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">SafePoker</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://bestcstutor.github.io/2019/10/20/Java%E4%BB%A3%E5%86%99%EF%BC%9ACIS455WebandApplicationServer/">https://bestcstutor.github.io/2019/10/20/Java%E4%BB%A3%E5%86%99%EF%BC%9ACIS455WebandApplicationServer/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">SafePoker</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Java%E4%BB%A3%E5%86%99/">
                                    <span class="chip bg-color">Java代写</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s12 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/newqrcode.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2019/10/20/C++%E4%BB%A3%E5%86%99%EF%BC%9ACOMP206Otodecks/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="C++代写：COMP206Otodecks">
                        
                        <span class="card-title">C++代写：COMP206Otodecks</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2019-10-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/C-%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">C++代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/10/19/Java%E4%BB%A3%E5%86%99%EF%BC%9ACS142RockPaperScissors/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="Java代写：CS142RockPaperScissors">
                        
                        <span class="card-title">Java代写：CS142RockPaperScissors</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2019-10-19
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Java代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2024</span>
            
            <a href="/contact" target="_blank">SafePoker</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:hhh@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
