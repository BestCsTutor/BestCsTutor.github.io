<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SQL代写：COMP9311SQL, cs辅导|cs代写|计算机辅导|AI辅导|网络安全">
    <meta name="description" content="编写  PostgreSQL 语句，完成MyMyUNSW数据库的12个问题。![PostgreSQL](https://blog.xojo.com/wp-content/uploads/2017/06/postgresql-card.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>SQL代写：COMP9311SQL | cs辅导|cs代写|计算机辅导|AI辅导|网络安全</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.1.1"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">cs辅导|cs代写|计算机辅导|AI辅导|网络安全</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>作业思路分享</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/comment" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>用户评价</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>联系我</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">cs辅导|cs代写|计算机辅导|AI辅导|网络安全</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			作业思路分享
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/comment" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			用户评价
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			联系我
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">SQL代写：COMP9311SQL</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/SQL%E4%BB%A3%E5%86%99/">
                                <span class="chip bg-color">SQL代写</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-07-06
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>编写 <a target="_blank" rel="noopener" href="https://www.postgresql.org/" title="PostgreSQL"> PostgreSQL </a><br>语句，完成MyMyUNSW数据库的12个问题。<br>![PostgreSQL](<a target="_blank" rel="noopener" href="https://blog.xojo.com/wp-content/uploads/2017/06/postgresql-">https://blog.xojo.com/wp-content/uploads/2017/06/postgresql-</a><br>card.png)</p>
<h2 id="Aims"><a href="#Aims" class="headerlink" title="Aims"></a>Aims</h2><p>This project aims to give you practice in</p>
<ul>
<li>Reading and understanding a moderately large relational schema (MyMyUNSW). </li>
<li>Implementing SQL queries and views to satisfy requests for information. </li>
<li>Implementing PL&#x2F;pgSQL functions to aid in satisfying requests for information </li>
<li>The goal is to build some useful data access operations on the MyMyUNSW database. The data may contain some data inconsistencies; however, they won’t affect your answers to the project.</li>
</ul>
<h2 id="How-to-do-this-project"><a href="#How-to-do-this-project" class="headerlink" title="How to do this project:"></a>How to do this project:</h2><ul>
<li>Read this specification carefully and completely </li>
<li>Familiarize yourself with the database schema (description, SQL schema, summary) </li>
<li>Make a private directory for this project, and put a copy of the proj1.sql template there </li>
<li>You must use the create statements in proj1.sql when defining your solutions </li>
<li>Look at the expected outputs in the expected_qX tables loaded as part of the check.sql file </li>
<li>Solve each of the problems below, and put your completed solutions into proj1.sql </li>
<li>Check that your solution is correct by verifying against the example outputs and by using the check_qX() functions </li>
<li>Test that your proj1.sql file will load without error into a database containing just the original MyMyUNSW data </li>
<li>Double-check that your proj1.sql file loads in a single pass into a database containing just the original MyMyUNSW data </li>
<li>Submit the project via moodle </li>
<li>For each question, you must output result within 120 seconds on Nw-syd-vxdb server. </li>
<li>Hardcode is strictly forbidden.</li>
</ul>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>All Universities require a significant information infrastructure in order to<br>manage their affairs. This typically involves a large commercial DBMS<br>installation. UNSW’s student information system sits behind the MyUNSW web<br>site. MyUNSW provides an interface to a PeopleSoft enterprise management<br>system with an underlying Oracle database. This back-end system<br>(Peoplesoft&#x2F;Oracle) is often called NSS.<br>UNSW has spent a considerable amount of money ($80M+) on the MyUNSW&#x2F;NSS<br>system, and it handles much of the educational administration plausibly well.<br>Most people gripe about the quality of the MyUNSW interface, but the system<br>does allow you to carry out most basic enrolment tasks online.<br>Despite its successes, MyUNSW&#x2F;NSS still has several deficiencies, including:</p>
<ul>
<li>no waiting lists for course or class enrolment </li>
<li>no representation for degree program structures </li>
<li>poor integration with the UNSW Online Handbook<br>The first point is inconvenient, since it means that enrolment into a full<br>course or class becomes a sequence of trial-and-error attempts, hoping that<br>somebody has dropped out just before you attempt to enroll and that no-one<br>else has grabbed the available spot.<br>The second point prevents MyUNSW&#x2F;NSS from being used for three important<br>operations that would be extremely helpful to students in managing their<br>enrolment:</li>
<li>finding out how far they have progressed through their degree program, and what remains to be completed </li>
<li>checking what are their enrolment options for next semester (e.g., get a list of available courses) </li>
<li>determining when they have completed all the requirements of their degree program and are eligible to graduate<br>NSS contains data about student, courses, classes, pre-requisites, quotas,<br>etc. but does not contain any representation of UNSW’s degree program<br>structures. Without such information in the NSS database, it is not possible<br>to do any of the above three. So, in 2007 the COMP9311 class devised a data<br>model that could represent program requirements and rules for UNSW degrees.<br>This was built on top of an existing schema that represented all the core NSS<br>data (students, staff, courses, classes, etc.). The enhanced data model was<br>named the MyMyUNSW schema.<br>The MyMyUNSW database includes information that encompasses the functionality<br>of NSS, the UNSW Online Handbook, and the CATS (room allocation) database. The<br>MyMyUNSW data model, schema and database are described in a separate document.</li>
</ul>
<h2 id="Setting-Up"><a href="#Setting-Up" class="headerlink" title="Setting Up"></a>Setting Up</h2><p>To install the MyMyUNSW database under your Nw-syd-vxdb server, simply run the<br>following two commands:<br>    $ createdb proj1<br>    $ psql proj1 -f &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;23T2&#x2F;proj&#x2F;proj1&#x2F;mymyunsw.dump<br>If you’ve already set up PLpgSQL in your template1 database, you will get one<br>error message as the database starts to load:<br>    psql:mymyunsw.dump:NN: ERROR: language “plpgsql” already exist.<br>You can ignore the above error message, but all other occurrences of ERROR<br>during the load needs to be investigated.<br>If everything proceeds correctly, the load output should look something like:<br>    SET<br>    SET<br>    SET<br>    SET<br>    SET<br>    psql:mymyunsw.dump:NN: ERROR: language “plpgsql” already exists<br>    … if PLpgSQL is not already defined,<br>    … the above ERROR will be replaced by CREATE LANGUAGE<br>    SET<br>    SET<br>    SET<br>    CREATE TABLE<br>    CREATE TABLE<br>    … a whole bunch of these<br>    CREATE TABLE<br>    ALTER TABLE<br>    ALTER TABLE<br>    … a whole bunch of these<br>    ALTER TABLE<br>Apart from possible messages relating to plpgsql, you should get no error<br>messages.<br>The database loading should take less than 60 seconds on Nw-syd-vxdb, assuming<br>that Nw-syd-vxdb is not under heavy load. (If you leave your project until the<br>last minute, loading the database on Nwsyd-vxdb will be considerably slower,<br>thus delaying your work even more. The solution: at least load the database<br>Right Now, even if you don’t start using it for a while.) (Note that the<br>mymyunsw.dump file is 50MB in size; copying it under your home directory or<br>your &#x2F;srvr directory is not a good idea).<br>If you have other large databases under your PostgreSQL server on Nw-syd-vxdb<br>or if you have large files under your &#x2F;srvr&#x2F;YOU&#x2F; directory, it is possible<br>that you will exhaust your Nw-syd-vxdb disk quota. Regardless, it is certain<br>that you will not be able to store two copies of the MyMyUNSW database under<br>your Nw-syd-vxdb server. The solution: remove any existing databases before<br>loading your MyMyUNSW database.</p>
<h3 id="Summary-on-Getting-Started"><a href="#Summary-on-Getting-Started" class="headerlink" title="Summary on Getting Started"></a>Summary on Getting Started</h3><p>To set up your database for this project, run the following commands in the<br>order supplied:<br>    $ createdb proj1<br>    $ psql proj1 -f &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;23T2&#x2F;proj&#x2F;proj1&#x2F;mymyunsw.dump<br>    $ psql proj1<br>    … run some checks to make sure the database is ok<br>    $ mkdir Project1Directory<br>    … make a working directory for Project 1<br>    $ cp &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;23T2&#x2F;proj&#x2F;proj1&#x2F;proj1.sql Project1Directory<br>The only error messages produced by these commands should be those noted<br>above. If you omit any of the steps, then things will not work as planned.</p>
<h2 id="Important-Advice-Before-You-Start"><a href="#Important-Advice-Before-You-Start" class="headerlink" title="Important Advice Before You Start"></a>Important Advice Before You Start</h2><p>The database instance you are given is not a small one. The first thing you<br>should do is get a feeling for what data is there in the database. This will<br>help you understand the schema better and will make the tasks easier to<br>understand. Tip: study the schema of each table to see how tables are related<br>and try write some queries to explore&#x2F; understand what each table is storing.<br>    $ psql proj1<br>    proj1&#x3D;# \d<br>    … study the schema …<br>    proj1&#x3D;# select * from Students;<br>    … look at the data in the Students table … proj1&#x3D;# select p.unswid,p.name from People p join Students s on (p.id&#x3D;s.id);<br>    … look at the names and UNSW ids of all students …<br>    proj1&#x3D;# select p.unswid,p.name,s.phone from People p join Staff s on (p.id&#x3D;s.id);<br>    … look at the names, staff ids, and phone #s of all staff …<br>    proj1&#x3D;# select count(*) from Course_Enrolments;<br>    … get an idea of the number of records each table has…<br>    proj1&#x3D;# select * from dbpop();<br>    … how many records in all tables …<br>    proj1&#x3D;# … etc. etc. etc.<br>    proj1&#x3D;# \q<br>Read these before you start on the exercises:</p>
<ul>
<li>The marks reflect the relative difficulty&#x2F;length of each question. </li>
<li>Work on the project on the supplied proj1.sql template file. </li>
<li>Make sure that your queries work on any instance of the MyMyUNSW schema; don’t customize them to work just on this database; we may test them on a different database instance. </li>
<li>Do not assume that any query will return just a single result; even if it phrased as “most” or “biggest”, there may be two or more equally “big” instances in the database. </li>
<li>When queries ask for people’s names, use the Person.name field; it’s there precisely to produce displayable names. </li>
<li>When queries ask for student ID, use the People.unswid field; the People.id field is an internal numeric key and of no interest to anyone outside the database. </li>
<li>Unless specifically mentioned in the exercise, the order of tuples in the result does not matter; it can always be adjusted using order by. In fact, our check.sql will order your results automatically for comparison. </li>
<li>The precise formatting of fields within a result tuple does matter, e.g., if you convert a number to a string using to_char it may no longer match a numeric field containing the same value, even though the two fields may look similar. </li>
<li>We advise developing queries in stages; make sure that any sub-queries or sub-joins that you’re using works correctly before using them in the query for the final view&#x2F;function </li>
<li>You may define as many additional views as you need, provided that (a) the definitions in proj1.sql are preserved, (b) you follow the requirements in each question on what you are allowed to define. </li>
<li>If you meet with error saying something like “cannot change name of view column”, you can drop the view you just created by using command “drop view VIEWNAME cascade;” then create your new view again.<br>Each question is presented with a brief description of what’s required. If you<br>want the full details of the expected output, look at the expected_qX tables<br>supplied in the checking script (check.sql) once we release it.</li>
</ul>
<h2 id="Tasks"><a href="#Tasks" class="headerlink" title="Tasks"></a>Tasks</h2><p>To facilitate the semi-auto marking, please pack all your SQL solutions into<br>view&#x2F;function as defined in each problem (see details from the solution<br>template we provided).</p>
<h3 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h3><p>Define a SQL view Q1(subject_code) that gives all the subjects that are<br>offered by organizations whose type is centre.</p>
<ul>
<li>subject_code should be taken from Subjects.code field; </li>
<li>Centre refers to the Orgunit_types.name field that contains ‘Centre’.</li>
</ul>
<h3 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h3><p>Define an SQL view Q2(course_id) that gives the id of the course that has at<br>least 4 different types of classes, where one of them should be seminar.</p>
<ul>
<li>course_id should be taken from Courses.id field; </li>
<li>Seminar refers to the Class_types.name field that contains ‘Seminar’.</li>
</ul>
<h3 id="Question-3"><a href="#Question-3" class="headerlink" title="Question 3"></a>Question 3</h3><p>Define a SQL view Q3(unsw_id)that gives the unswid of students who enrolled in<br>at least two courses in year 2010. Only consider the course that is equivalent<br>to at least one JURD course and at least one LAWS course at the same time<br>(i.e., with a course code of the format JURD ****and<br>LAWS ** ** ).</p>
<ul>
<li>equivalent refers to subject._equivalent field; </li>
<li>unsw_id should be taken from people.unswid field.</li>
</ul>
<h3 id="Question-4"><a href="#Question-4" class="headerlink" title="Question 4"></a>Question 4</h3><p>Define an SQL view Q4(course_id, avg_mark) that gives the course who has the<br>maximum average mark among all the COMP courses in year 2010. When calculating<br>the average mark, we only count the students with valid marks (not null).<br>Round avg_mark to the nearest 0.0001. (i.e., if avg_mark &#x3D; 90.01 , then return<br>90.0100; if avg_mark &#x3D; 85.01234, then return 85.0123; if avg_mark &#x3D; 72.02345,<br>then return 72.0235). This rounding behavior is different from the IEEE 754<br>specification for floating point rounding which PostgreSQL uses for<br>float&#x2F;real&#x2F;double precision types. PostgreSQL only performs this type of<br>rounding for numeric and decimal types. If there are multiple courses that<br>have the maximum average mark, return all of them.</p>
<ul>
<li>COMP courses refer to the courses whose related Subjects.code contains ‘COMP’. </li>
<li>course_id should be taken from Courses.id; </li>
<li>avg_mark should be in numeric type.</li>
</ul>
<h3 id="Question-5"><a href="#Question-5" class="headerlink" title="Question 5"></a>Question 5</h3><p>Define a SQL view Q5(faculty_id, room_id)that gives the faculties and rooms<br>that held the maximum number of tutorials offered by the corresponding<br>faculties among all the rooms in the year 2005. A tutorial is offered by a<br>faculty if it belongs to a course whose related subject is offered by this<br>faculty. If there are multiple rooms that held the maximum number of<br>tutorials, return all of them.</p>
<ul>
<li>Faculty refers to an organization where its Orgunit_types.name contains Faculty’; </li>
<li>Tutorial refers to the class where class_types.name is ‘Tutorial’; </li>
<li>Faculty_id should be taken from Orgunits.id field; </li>
<li>room_id should be taken from Rooms.id field.</li>
</ul>
<h3 id="Question-6"><a href="#Question-6" class="headerlink" title="Question 6"></a>Question 6</h3><p>Define a SQL view Q6(program_id, stream_id)that gives the programs offered by<br>Faculty of Arts and Social Sciences in semester 2005 S1 and the streams with<br>the highest number of enrolments in the corresponding program among all the<br>streams that can be enrolled as part of this program in semester 2005 S1.</p>
<ul>
<li>program_id should be taken from Programs.id field; </li>
<li>stream_id should be taken from Streams.id field.</li>
</ul>
<h3 id="Question-7"><a href="#Question-7" class="headerlink" title="Question 7"></a>Question 7</h3><p>Define a SQL view Q7(subject_id, staff_name) that gives the subjects who are<br>offered by Law organizations and provided at least two courses in year 2008,<br>and the corresponding course staffs who were associated with the teaching for<br>all the courses related to those subjects in that year. The results should not<br>contain the subjects with no course staff. If a subject associates with more<br>than one course staff, return all of them. The view should return the<br>following details:</p>
<ul>
<li>Law organization refers to an organization where its Orgunits.name contains ‘Law’ (regardless of case). </li>
<li>subject_id should be taken from Subjects.id field; </li>
<li>staff_name should be taken from People.name field.</li>
</ul>
<h3 id="Question-8"><a href="#Question-8" class="headerlink" title="Question 8"></a>Question 8</h3><p>Define SQL view Q8(unsw_id, name) that gives all the distinct students who<br>enrolled in the programs offered by Faculty of Science and have ranked top 10<br>only in math-related courses. Math-related courses refer to the courses whose<br>related subject code starts with ‘MATH’.<br>We only consider the courses that have been enrolled by over than 100<br>students. The view should return the following details about each student:</p>
<ul>
<li>unsw_id should be taken from People.unswid field; </li>
<li>name should be taken from People.name field.<br>Note:</li>
<li>If a student has enrolled into several different programs, you only need to consider the course included by the program offered by Faculty of Science. A course is included in a program if this student enrolls into the course and the program in the same semester (refer to Semesters.id); </li>
<li>To identify top 10 students in a course, the ranking is based on the marks received by the students(refer to Course_enrolments.mark) in this course, from highest to lowest. If multiple students have achieved the same mark, they should be assigned with the same ranking. The Rank() function in PostgreSQL will be able to do this for you to generate the ranking column.</li>
</ul>
<h3 id="Question-9"><a href="#Question-9" class="headerlink" title="Question 9"></a>Question 9</h3><p>Define SQL view Q9(prof_id, fail_rate) that gives all the professors from<br>School of Mechanical and Manufacturing Engineering and the fail rate of all<br>the UG courses where they are employed as course convenor. We only count the<br>students with valid marks (not null).</p>
<ul>
<li>Failing a course means that Course_enrolments.mark is lower than 50. </li>
<li>A person is identified as a professor if his&#x2F;her staff_roles.name contains ‘Professor’ (regardless of case) in an affiliation. </li>
<li>A person is employed as a course convenor for a course if his&#x2F;hers staff_roles.name is ‘Course Convenor’ in course_staff. </li>
<li>UG refers to Subjects.career. </li>
<li>If a professor does not teach any UG course, then do not include he&#x2F;she in the results. </li>
<li>Round the fail rate to the nearest 0.0001. Use the same rule as Question 4.<br>The view should return the following details:</li>
<li>prof_id should be taken from People.unswid field; </li>
<li>fail_rate should be in numeric type.</li>
</ul>
<h3 id="Question-10"><a href="#Question-10" class="headerlink" title="Question 10"></a>Question 10</h3><p>Define a SQL view Q10(student_id, program_id, remain_uoc) that gives the MA<br>students who may fail to graduate, the corresponding program and the remaining<br>UOC they need to graduate. A student who fails to graduate should satisfy the<br>following conditions in one program:</p>
<ul>
<li>Enroll a program in MA (refer to Program_degrees.abbrev); </li>
<li>The total UOC (refer to Subjects.uoc) earned in the program (exclusive) is less than half of the required UOC of the program. A student can only earn the UOC of the courses he&#x2F;she pass, i.e., the mark for the course (refers to Course_enrolments.mark) should be no less than 50. </li>
<li>The duration he&#x2F;she enrolled into this program exceeds 2000 days. For each student, the duration is the number of days between the earliest date(refer to Semesters.starting) and the latest date(refer to Semesters.ending) among all his&#x2F;her enrolments for the same program.<br>The view should return the following details about each student:</li>
<li>Student_id should be taken from People.unswid field; </li>
<li>Program_id should be taken from Programs.id field; </li>
<li>remain_uoc should be an integer.<br>Note:</li>
<li>Remaining UOC &#x3D; required UOC - earned UOC. </li>
<li>If a student has enrolled into several different programs, you need to calculate the UOC separately according to different programs. A course is included in a program if this student enrolled into the course and the program in the same semester (refer to Semesters.id).</li>
</ul>
<h3 id="Question-11"><a href="#Question-11" class="headerlink" title="Question 11"></a>Question 11</h3><p>Define a PL&#x2F;pgSQL function Q11(year courseyeartype, term character(2),<br>orgunit_id integer)that takes a year, a term and an orgunit id, and returns<br>the grade distribution ratio for all the students enrolled in the programs<br>offered by the given organization.</p>
<ul>
<li>year is taken from Semesters.year field; </li>
<li>term is taken from Semesters.term field; </li>
<li>orgunit_id is taken from Orgunits.id field.<br>For each student, the grade is based on the average mark of the courses<br>enrolled in the given semester. The grading rules are as follows:</li>
<li>i. HD if 85 &lt;&#x3D; semester average mark. </li>
<li>ii. DN if 75 &lt;&#x3D; semester average mark &lt; 85. </li>
<li>iii. CR if 65 &lt;&#x3D; semester average mark &lt; 75. </li>
<li>iv. PS if 50 &lt;&#x3D; semester average mark &lt; 65. </li>
<li>v. FL otherwise.<br>Each line of the output (in text type) should contain the following two<br>elements and they are concatenated with a space:</li>
<li>The grade which is represented by 2 characters. </li>
<li>The corresponding rate (which should be in numeric type).<br>The rate &#x3D; number of students who received a particular grade total number of<br>students enrolled in programs offered by the given organization. Round the<br>rate to the nearest 0.0001. Use the same rule as Question 4. If a student did<br>not receive any mark in the given semester, ignore this student during the<br>calculation. See check file for examples. We will only test with valid inputs.</li>
</ul>
<h3 id="Question-12"><a href="#Question-12" class="headerlink" title="Question 12"></a>Question 12</h3><p>Define a PL&#x2F;pgSQL function Q12(subject_prefix character(4)) that takes the<br>prefix of subject code, and returns the associated courses where the course<br>staff is from at least 4 different organizations, and the corresponding<br>organizations. See check file for examples. We will only test with valid<br>inputs.</p>
<ul>
<li>Associated courses refer to the courses where the code of the related subjects starts with subject_prefix.<br>Each line of output (in text type) should contain the following two elements<br>and they are concatenated with a space:</li>
<li>A course id should be taken from Courses.id field; </li>
<li>A list of id taken from Orgunits.id concatenated with slash ‘&#x2F;‘. Note that the id should be in ascending order (lowest to highest).</li>
</ul>
<h2 id="Submission"><a href="#Submission" class="headerlink" title="Submission"></a>Submission</h2><p>You can submit this project by doing the following:</p>
<ul>
<li>Students must submit an electronic copy of their answers to the above questions to the course website in Moodle. </li>
<li>The file name should be proj1_studentID.sql (e.g., proj1_z5100000.sql). </li>
<li>If you submit your project more than once, the last submission will replace the previous one </li>
<li>In case that the system is not working properly, you must take the following actions: </li>
<li>Please keep a copy of your submitted file on the CSE server. If you are not sure how, please have a look at taggi.<br>The proj1.sql file should contain answers to all the exercises for this<br>project. It should be completely self-contained and able to load in a single<br>pass, so that it can be auto-tested as follows:</li>
<li>A fresh copy of the MyMyUNSW database will be created (using the schema from mymyunsw.dump) </li>
<li>The data in this database may be different from the database that you’re using for testing </li>
<li>A new check.sql file may be loaded (with expected results appropriate for the database) </li>
<li>The contents of your proj1.sql file will be loaded </li>
<li>Each checking function will be executed, and the results recorded</li>
</ul>
<h2 id="Check-your-Answers"><a href="#Check-your-Answers" class="headerlink" title="Check your Answers"></a>Check your Answers</h2><p>Before you submit your solution, you should check that it loads correctly for<br>testing by using something like the following operations. For function<br>questions, we provide five testcases for each question (E.g., for question 11,<br>they are q11a to q11e). Testcases can be found from line228 in check.sql:<br>    $ dropdb proj1    … remove any existing DB<br>    $ createdb proj1  … create an empty database<br>    $ psql proj1 -f &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;23T2&#x2F;proj&#x2F;proj1&#x2F;mymyunsw.dump     … load the MyMyUNSW schema and data<br>    $ psql proj1 -f &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;23T2&#x2F;proj&#x2F;proj1&#x2F;check.sql         … load the checking code<br>    $ psql proj1 -f proj1.sql … load your solution<br>    $ psql proj1<br>    proj1&#x3D;# select check_q1();  … check your solution to question1<br>    …<br>    proj1&#x3D;# select check_q6();  … check your solution to question6<br>    …<br>    proj1&#x3D;# select check_q12a();  … check your solution to question12 testcase (a)<br>    …<br>    proj1&#x3D;# select check_all();  … check all your solutions<br>Notes:</p>
<ol>
<li>You must ensure that your proj1.sql file will load and runs correctly (i.e., it has no syntax errors, and it contains all your view definitions in the correct order).<br>* a. If your database contains any views that are not available in a file somewhere, you should put them into a file before you drop the database.<br>* b. If we need to manually fix problems with your proj1.sql file in order to test it (e.g., change the order of some definitions), you will be fined via half of the mark penalty for each problem.<br>* c. If your code loads with errors, fix it and repeat the above until it does not. </li>
<li>In addition, write queries that are reasonably efficient.<br>* a. For each question, you must output result within 120 seconds on Nw-syd-vxdb server. This time restriction applies to the execution of the ‘select * from check_Qn()’ calls.<br>* b. For each question, you will be fined via half of the mark penalty if your solution cannot output results within 120 seconds.</li>
</ol>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">SafePoker</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://bestcstutor.github.io/2020/07/06/SQL%E4%BB%A3%E5%86%99%EF%BC%9ACOMP9311SQL/">https://bestcstutor.github.io/2020/07/06/SQL%E4%BB%A3%E5%86%99%EF%BC%9ACOMP9311SQL/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">SafePoker</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/SQL%E4%BB%A3%E5%86%99/">
                                    <span class="chip bg-color">SQL代写</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s12 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/newqrcode.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/07/12/Python%E4%BB%A3%E5%86%99%EF%BC%9ACS3024Battleship/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="Python代写：CS3024Battleship">
                        
                        <span class="card-title">Python代写：CS3024Battleship</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-07-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Python代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/07/05/PHP%E4%BB%A3%E5%86%99%EF%BC%9ACS306HotelReservationSystem/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="PHP代写：CS306HotelReservationSystem">
                        
                        <span class="card-title">PHP代写：CS306HotelReservationSystem</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-07-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/PHP%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">PHP代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2024</span>
            
            <a href="/contact" target="_blank">SafePoker</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:hhh@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
