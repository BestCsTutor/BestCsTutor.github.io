<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SQL代写：CS9311 MyUNSW System, 留学生CS|辅导|代写">
    <meta name="description" content="完成UNSW的  PostgreSQL 数据库作业，分成两个部分。![PgSQL](https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Postgresql_elephant.">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>SQL代写：CS9311 MyUNSW System | 留学生CS|辅导|代写</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.1.1"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">留学生CS|辅导|代写</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>辅导案例集合</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/comment" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>用户评价</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>联系我</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">留学生CS|辅导|代写</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			辅导案例集合
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/comment" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			用户评价
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			联系我
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/22.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">SQL代写：CS9311 MyUNSW System</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/SQL%E4%BB%A3%E5%86%99/">
                                <span class="chip bg-color">SQL代写</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-03-29
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>完成UNSW的 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/PostgreSQL" title="PostgreSQL"> PostgreSQL </a><br>数据库作业，分成两个部分。<br>![PgSQL](<a target="_blank" rel="noopener" href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Postgresql_elephant.svg/220px-">https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Postgresql_elephant.svg/220px-</a><br>Postgresql_elephant.svg.png)</p>
<h2 id="Aims"><a href="#Aims" class="headerlink" title="Aims"></a>Aims</h2><p>This project aims to give you practice in</p>
<ul>
<li>reading and understanding a moderately large relational schema (MyMyUNSW). </li>
<li>implementing SQL queries and views to satisfy requests for information. </li>
<li>implementing PLpgSQL functions to aid in satisfying requests for information</li>
</ul>
<h2 id="How-to-do-this-project"><a href="#How-to-do-this-project" class="headerlink" title="How to do this project"></a>How to do this project</h2><ul>
<li>Read this specification carefully and completely </li>
<li>Familiarize yourself with the database schema (description, SQL schema, summary) </li>
<li>Make a private directory for this project, and put a copy of the proj1.sql template there </li>
<li>You must use the create statements in proj1.sql when defining your solutions </li>
<li>Look at the expected outputs in the expected_qX tables loaded as part of the check.sql file </li>
<li>Solve each of the problems below, and put your completed solutions into proj1.sql </li>
<li>Check that your solution is correct by verifying against the example outputs and by using the check_qX() functions </li>
<li>Test that your proj1.sql file will load without error into a database containing just the original MyMyUNSW data </li>
<li>Double-check that your proj1.sql file loads in a single pass into a database containing just the original MyMyUNSW data </li>
<li>Submit the project via moodle </li>
<li>For each question, you must output result within 120 seconds on Grieg server.</li>
</ul>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>All Universities require a significant information infrastructure in order to<br>manage their affairs. This typically involves a large commercial DBMS<br>installation. UNSW’s student information system sits behind the MyUNSW web<br>site. MyUNSW provides an interface to a PeopleSoft enterprise management<br>system with an underlying Oracle database. This back-end system<br>(Peoplesoft&#x2F;Oracle) is often called NSS.<br>UNSW has spent a considerable amount of money ($80M+) on the MyUNSW&#x2F;NSS<br>system, and it handles much of the educational administration plausibly well.<br>Most people gripe about the quality of the MyUNSW interface, but the system<br>does allow you to carry out most basic enrolment tasks online.<br>Despite its successes, MyUNSW&#x2F;NSS still has a number of deficiencies,<br>including:</p>
<ul>
<li>no waiting lists for course or class enrolment </li>
<li>no representation for degree program structures </li>
<li>poor integration with the UNSW Online Handbook<br>The first point is inconvenient, since it means that enrolment into a full<br>course or class becomes a sequence of trial-and-error attempts, hoping that<br>somebody has dropped out just before you attempt to enrol and that no-one else<br>has grabbed the available spot.<br>The second point prevents MyUNSW&#x2F;NSS from being used for three important<br>operations that would be extremely helpful to students in managing their<br>enrolment:</li>
<li>finding out how far they have progressed through their degree program, and what remains to be completed </li>
<li>checking what are their enrolment options for next semester (e.g., get a list of available courses) </li>
<li>determining when they have completed all of the requirements of their degree program and are eligible to graduate<br>NSS contains data about student, courses, classes, pre-requisites, quotas,<br>etc. but does not contain any representation of UNSW’s degree program<br>structures. Without such information in the NSS database, it is not possible<br>to do any of the above three. So, in 2007 the COMP9311 class devised a data<br>model that could represent program requirements and rules for UNSW degrees.<br>This was built on top of an existing schema that represented all of the core<br>NSS data (students, staff, courses, classes, etc.). The enhanced data model<br>was named the MyMyUNSW schema.<br>The MyMyUNSW database includes information that encompasses the functionality<br>of NSS, the UNSW Online Handbook, and the CATS (room allocation) database. The<br>MyMyUNSW data model, schema and database are described in a separate document.</li>
</ul>
<h2 id="Setting-Up"><a href="#Setting-Up" class="headerlink" title="Setting Up"></a>Setting Up</h2><p>To install the MyMyUNSW database under your Grieg server, simply run the<br>following two commands:<br>    $ createdb proj1<br>    $ psql proj1 -f &#x2F;home&#x2F;cs9311&#x2F;web&#x2F;21T1&#x2F;proj&#x2F;proj1&#x2F;mymyunsw.dump<br>If you’ve already set up PLpgSQL in your template1 database, you will get one<br>error message as the database starts to load:<br>psql:mymyunsw.dump:NN: ERROR: language “plpgsql” already exists<br>You can ignore this error message, but any other occurrence of ERROR during<br>the load needs to be investigated.<br>Apart from possible messages relating to plpgsql, you should get no error<br>messages. The database loading should take less than 60 seconds on Grieg,<br>assuming that Grieg is not under heavy load. (If you leave your project until<br>the last minute, loading the database on Grieg will be considerably slower,<br>thus delaying your work even more. The solution: at least load the database<br>Right Now, even if you don’t start using it for a while.) (Note that the<br>mymyunsw.dump file is 50MB in size; copying it under your home directory or<br>your &#x2F;srvr directory is not a good idea).<br>If you have other large databases under your PostgreSQL server on Grieg or you<br>have large files under your &#x2F;srvr&#x2F;YOU&#x2F; directory, it is possible that you will<br>exhaust your Grieg disk quota. In particular, you will not be able to store<br>two copies of the MyMyUNSW database under your Grieg server. The solution:<br>remove any existing databases before loading your MyMyUNSW database.<br>If you are running PostgreSQL at home, you can download the files:<br>mymyunsw.dump, proj1.sql to get you started. You can grab the check.sql<br>separately, once it becomes available.<br>A useful thing to do initially is to get a feeling for what data is actually<br>there. This may help you understand the schema better and will make the<br>descriptions of the exercises easier to understand. Look at the schema. Ask<br>some queries. Do it now.</p>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><p>Read these before you start on the exercises:</p>
<ul>
<li>the marks reflect the relative difficulty&#x2F;length of each question </li>
<li>use the supplied proj1.sql template file for your work </li>
<li>you may define as many additional functions and views as you need, provided that (a) the definitions in proj1.sql are preserved, (b) you follow the requirements in each question on what you are allowed to define </li>
<li>make sure that your queries would work on any instance of the MyMyUNSW schema; don’t customize them to work just on this database; we may test on a different instance </li>
<li>do not assume that any query will return just a single result; even if it phrased as “most” or “biggest”, there may be two or more equally “big” instances in the database </li>
<li>when queries ask for people’s names, use the Person.name field; it’s there precisely to produce displayable names </li>
<li>when queries ask for student ID, use the People.unswid field; the People.id field is an internal numeric key and of no interest to anyone outside the database </li>
<li>unless specifically mentioned in the exercise, the order of tuples in the result does not matter; it can always be adjusted using order by. In fact, our check.sql will order your results automatically for comparison. </li>
<li>the precise formatting of fields within a result tuple does matter, e.g., if you convert a number to a string using to_char it may no longer match a numeric field containing the same value, even though the two fields may look similar </li>
<li>develop queries in stages; make sure that any sub-queries or sub-joins that you’re using actually work correctly before using them in the query for the final view&#x2F;function </li>
<li>You can define SQL views to answer the following questions. </li>
<li>If you meet with error saying something like “cannot change name of view column”, you can drop the view you just created by using command “drop view VIEWNAME cascade;” then create your new view again.<br>Each question is presented with a brief description of what’s required. If you<br>want the full details of the expected output, take a look at the expected_qX<br>tables supplied in the checking script.</li>
</ul>
<h2 id="Tasks"><a href="#Tasks" class="headerlink" title="Tasks"></a>Tasks</h2><p>To facilitate the semi-auto marking, please pack all your SQL solutions into<br>view as defined in each problem (see details from the solution template we<br>provided).</p>
<h3 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h3><p>Define an SQL view Q1(subject_longname, subject_num) that gives the longname<br>(refers to the subjects.longname) of the PhD related subject and the number of<br>subjects having the same subject longname.<br>Note:</p>
<ul>
<li>Only consider the subject_longname that contains ‘PhD’ (not ‘Ph.D’). </li>
<li>Only consider the subject_longname with more than one subjects (subject_num]1).</li>
</ul>
<h3 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h3><p>Define an SQL view Q2(OrgUnit_id, OrgUnit, OrgUnit_type, Program) that gives<br>the details of the OrgUnit which offers the programs having more than 300<br>total units of credit (refers to the Programs.UOC). The view should return the<br>following details about each course:</p>
<ul>
<li>OrgUnit_id should be taken from OrgUnits.id </li>
<li>OrgUnit should be taken from OrgUnits.name </li>
<li>OrgUnit_type should be taken from OrgUnit_types.name </li>
<li>Program should be taken from Programs.name</li>
</ul>
<h3 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h3><p>Define an SQL view Q3 (course, student_num, avg_mark)that gives the details of<br>the courses which are only taught by ‘Course Tutor’ and have the average marks<br>more than 70. The view should return the following details about each course:</p>
<ul>
<li>course should be taken from courses.id. </li>
<li>student_num should be the number of students for the course. </li>
<li>avg_mark should be computed from Course_enrolments.mark.<br>Note:</li>
<li>When calculating the average, onl y consider students who have a not null mark. </li>
<li>The mark of a course can be referred from Course_enrolments.mark. </li>
<li>Only consider valid courses which have at least more than 10 students. </li>
<li>The courses should be only taught by ‘Course Tutor’ rather than other types of staff. </li>
<li>return avg_mark as numeric (4,2).</li>
</ul>
<h3 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h3><p>Define an SQL view Q4(student_num) that gives the number of students who<br>enrolled the courses that having the Lecture classes held in both Quadrangle<br>and Red Centre buildings.<br>Note:</p>
<ul>
<li>The buildings are considered based on the Buildings.name filed. </li>
<li>The classes are considered based on the Class_types.name filed.</li>
</ul>
<h3 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h3><p>Define an SQL view Q5(staff, min_mark, course) that gives all the distinct<br>staffs who have taught the courses offered by the School of Law (refers to the<br>OrgUnits.Name).<br>We also want to know the minimum mark of the courses he taught and the<br>corresponding course. The view should return the following details about each<br>staff:</p>
<ul>
<li>staff should be taken from staff.id field. </li>
<li>min_mark should be considered on the Course_enrolments.mark field. </li>
<li>course should be considered on the Courses.id field.<br>Note:</li>
<li>If a staff taught many courses with the same minimum mark, we return all these courses. </li>
<li>When computing the marks, only consider students who have a not null mark. </li>
<li>The results should be ordered by the descending min_mark.</li>
</ul>
<h3 id="Q6"><a href="#Q6" class="headerlink" title="Q6"></a>Q6</h3><p>Define an SQL view Q6(course_id) that gives the courses, where less than 2&#x2F;5<br>of the enrolled students in the course have higher marks than the average mark<br>of the courses. For example, there are 20 students enrolled in the course A,<br>and the average mark of course A is 50. If there are 17 students get the marks<br>higher than 50, course A will be returned in the view Q6. The view should<br>return the following details about each course:</p>
<ul>
<li>course_id should be taken from Courses.id field.<br>Note:</li>
<li>Only consider the courses are enrolled by more than 10 students (who have not null marks) of the years 2009 and 2010 (refers to the Semesters.year). </li>
<li>When calculating the average, only consider students who have not null markss. </li>
<li>The mark of a course can be referred from Course_enrolments.mark</li>
</ul>
<h3 id="Q7"><a href="#Q7" class="headerlink" title="Q7"></a>Q7</h3><p>Define an SQL view Q7(staff_name, semester, course_num) that displays the<br>staff with the highest course_num in each semester between 2005 and 2007<br>(refers to the<br>Semesters.year), and course_num is the number of the courses a staff taught.<br>The view should return the following details about each course:</p>
<ul>
<li>Staff_name should be taken from People.name field. </li>
<li>semester should be taken from Semesters.longname field.<br>Note:</li>
<li>Only consider valid courses with at least 20 students. </li>
<li>If several staffs have the same highest course number, return all of them. </li>
<li>Skip the semester with no valid course.</li>
</ul>
<h3 id="Q8"><a href="#Q8" class="headerlink" title="Q8"></a>Q8</h3><p>Define an SQL view Q8(role_id, role_name, num_students) that gives the numbers<br>of distinct students taught by each role (refers to the Course_Staff.role) of<br>staff from School of Computer Science and Engineering (refers to the<br>Orgunits.longname) in 2010 (refers to the Semesters.year). The view should<br>return the following details about each course:</p>
<ul>
<li>role_id should be taken from Staff_roles.id field. </li>
<li>role_name should be taken from Staff_roles.name field.<br>Note:</li>
<li>Only consider distinct students taught by each role of staff. For example, if a student enrolled 5 courses which are taught by Course Lecturer, we only count this student once for Course Lecturer. </li>
<li>The affiliation of each staff can refer to the table Affiliations.</li>
</ul>
<h3 id="Q9"><a href="#Q9" class="headerlink" title="Q9"></a>Q9</h3><p>Data Management course admins would like to know the average mark of intl and<br>local students on each semester separately. Define an SQL view Q9(year, term,<br>stype, average_mark) to help them monitor the average mark each semester. Each<br>tuple in the view should contain the following:</p>
<ul>
<li>the year (Semesters.year) of the semester </li>
<li>the term (Semesters.term) </li>
<li>the type (Students.stype) </li>
<li>the average mark of students enrolled in this course this semester as numeric(4,2)<br>Database Systems has value ‘Data Management’ in the Subjects.name field. You<br>can find the information about all the course offerings for a given subject<br>from Courses. You should calculate the average mark of enrolled students for a<br>course offering from the table Course_enrolments.<br>Note:</li>
<li>When calculating the average marks, only consider not null mark records. </li>
<li>Only consider the semesters which have ‘Data Management’.</li>
</ul>
<h3 id="Q10"><a href="#Q10" class="headerlink" title="Q10"></a>Q10</h3><p>Define SQL view Q10(room, capacity, num), which gives, for each capacity, the<br>room with the greatest number of distinct facilities. The view should return<br>the following details about each room:</p>
<ul>
<li>room should be taken from Rooms.longname field. </li>
<li>capacity should be taken from Rooms.capacity field. </li>
<li>num counts the total number of distinct facilities in that room.<br>Note:</li>
<li>Ignore the rooms with no facility or no capacity. </li>
<li>Ignore the rooms with capacity less than 100 ( [ 100 ). </li>
<li>In the case of ties, the different rooms of same capacity with same number of facilities should all be included in the result.</li>
</ul>
<h3 id="Q11"><a href="#Q11" class="headerlink" title="Q11"></a>Q11</h3><p>Define SQL view Q11(staff, subject, num), which gives the maximum enrolment<br>number of the courses in each subject a staff taught. We only consider the<br>subjects a same staff has taught for at least three consecutive years (e.g.,<br>2000, 2001, 2002). The view should return the following details:</p>
<ul>
<li>staff should be taken from People.name field. </li>
<li>subject should be taken from Subjects.longname field. </li>
<li>num counts the maximum enrolment number of all valid courses in this subject taught by this staff.<br>Note:</li>
<li>Only consider the enrolments with not null mark. i.e., Course_enrolments.mark ]&#x3D; 0. </li>
<li>Only consider major semesters (i.e., S1 and S2). </li>
<li>Only consider staff with staff.id with 50354 (i.e., between 5035400 and 5035499 inclusive). </li>
<li>Ignore the courses with no valid enrolment and the subjects with no valid course.</li>
</ul>
<h3 id="Q12"><a href="#Q12" class="headerlink" title="Q12"></a>Q12</h3><p>Define SQL view Q12(staff, role, hd_rate), which gives the overall course high<br>distinction rate of the target staff for each specific role. A valid staff<br>should satisfy the following conditions:</p>
<ul>
<li>he&#x2F;she has taught at least two different subjects, in each of which he&#x2F;she had exactly three different staff roles. </li>
<li>he&#x2F;she can teach some other subjects, in which he&#x2F;she did not have three staff roles.<br>The view should return the following details about each staff:</li>
<li>staff should be taken from People.name field. </li>
<li>role should be taken from Staff_roles.name field. </li>
<li>hd_rate as numeric (4,2).<br>Note:</li>
<li>Only consider enrolments with not null marks. </li>
<li>To get a high distinction in a course, a student needs to get at least 85 in that course. i.e.,<br>Course_enrolments.mark ]&#x3D; 85.</li>
<li>To calculate the overall course pass rate, you need to find all enrolments of the courses with each staff being each staff role. Then you can divide the total number of the passed students by the total number to valid enrolments.</li>
</ul>
<h3 id="Q13"><a href="#Q13" class="headerlink" title="Q13"></a>Q13</h3><p>(You may use any combination of views, SQL functions and PLpgSQL functions in<br>this question.<br>However, you must define at least a PLpgSQL function called Q13. ) UNSW staff<br>members hold different roles at different periods of time. This information is<br>recorded in Affiliations table. Given the id of an organization, we want to<br>find all the staff members who have had at least two non-concurrent roles in<br>the given organization (i.e., they must have two roles where role1’s ending<br>date role 2’s starting date). Note that you need to consider the given<br>organization may have lots of sub-organizations. For example, the faculty of<br>engineering has many schools, such as biomedical engineering and CSE. Give the<br>id of an organization, write a PLpgSQL function to (a) find all the staff<br>members who have had several non-concurrent roles in the given organization<br>over time and (b) produce a list showing, for each staff member, their unswid,<br>name, and the roles they’ve had in the given organization (includes the name<br>of staff role, the name of organization, and starting date and ending date).<br>Note that the roles should be ordered by their starting date and bedisplayed<br>as a single string with the details for each role on a separate line<br>(terminated by ‘\n’).<br>Use the following type definition and function header: create type<br>EmploymentRecord as (unswid integer, staff_name text, roles text); create or<br>replace function Q13(integer) returns setof EmploymentRecord …<br>Note that PostgreSQL uses a + character to indicate an end-of-line in its<br>output (as well as printing ‘\n’). You may need to use array for this<br>question, and its documentation can be found at: here.</p>
<h2 id="Submission"><a href="#Submission" class="headerlink" title="Submission"></a>Submission</h2><p>You can submit this project by doing the following</p>
<ul>
<li>Students must submit an electronic copy of their answers to the above questions to the course website in Moodle. </li>
<li>The file names should be proj1.sql and proj2.sql. </li>
<li>If you submit your project more than once, the latest submission will replace the previous one </li>
<li>In case that the system is not working properly, you must take the following action: <ul>
<li>Please keep a copy of your submitted file on the CSE account. If you are not sure how, please have a look at taggi.<br>The proj1.sql and proj2.sql files should contain answers to all of the<br>exercises for this project. It should be completely self-contained and able to<br>load in a single pass, so that it can be auto-tested as follows:</li>
</ul>
</li>
<li>a fresh copy of the MyMyUNSW database will be created (using the schema from mymyunsw.dump) </li>
<li>the data in this database may be different from the database that you’re using for testing </li>
<li>a new check.sql file may be loaded (with expected results appropriate for the database) </li>
<li>the contents of your proj1.sql file will be loaded </li>
<li>each checking function will be executed, and the results recorded<br>Before you submit your solution, you should check that it will load correctly<br>for testing by using something like the following operations (same for proj2):</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">SafePoker</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://saferman.github.io/2023/03/29/SQL%E4%BB%A3%E5%86%99%EF%BC%9ACS9311MyUNSWSystem/">http://saferman.github.io/2023/03/29/SQL%E4%BB%A3%E5%86%99%EF%BC%9ACS9311MyUNSWSystem/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">SafePoker</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/SQL%E4%BB%A3%E5%86%99/">
                                    <span class="chip bg-color">SQL代写</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s12 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="wechat">
                        <img src="/medias/newqrcode.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/03/30/Python%E4%BB%A3%E5%86%99%EF%BC%9ACSC148HBlocky/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="Python代写：CSC148H Blocky">
                        
                        <span class="card-title">Python代写：CSC148H Blocky</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-03-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Python代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/03/28/Java%E4%BB%A3%E5%86%99%EF%BC%9ACSE100FFlightOperationsPart3/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="Java代写：CSE100F Flight Operations Part3">
                        
                        <span class="card-title">Java代写：CSE100F Flight Operations Part3</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-03-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            SafePoker
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java%E4%BB%A3%E5%86%99/">
                        <span class="chip bg-color">Java代写</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2018-2024</span>
            
            <a href="/contact" target="_blank">SafePoker</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:hhh@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
